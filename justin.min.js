const e=(t,n={})=>{if("string"==typeof t)return'"'===t[0]?t.slice(1,-1):"@"===t[0]?t.slice(1):t in n?n[t]:t;if(Array.isArray(t)){let o=t[0],s=Array.isArray(o)?e(o,n):r[o]||n[o]||o,a=[],l=1;for(;l<t.length;l++)a.push(e(t[l],n));return a.length>s.length&&s.length?a.reduce(s):s.apply(o,a)}return t},r={};let t,n;e.operator=(e,t)=>r[e]=t;const o=(e,r)=>(n=e,t=0,r=i(),t<n.length?s():h(r)),s=(e="Bad syntax")=>{throw Error(e+" `"+n[t]+"` at "+t)},a=(e=1,r=t)=>{if("number"==typeof e)t+=e;else for(;e(l());)t++;return n.slice(r,t)},l=(e=0)=>n.charCodeAt(t+e),f=(e=1)=>n.substr(t,e),i=(e=0,r,n,a,l=0,f,i)=>{for(;(n=o.space())&&(f=(i=c[n])&&i(a,e)||!a&&p(n));)a=f;return r&&(n!=r?s("Unclosed paren"):t++),a};o.space=e=>{for(;(e=l())<=32;)t++;return e};const u=o.token=[],p=(e,r=0,t)=>{for(;r<u.length;)if(t=u[r++](e))return t},c=[];o.operator=(e,r=0,n=0,s,u=e.charCodeAt(0),p=e.length,y=c[u],d=n<=0&&e.toUpperCase()!==e)=>(s=n?n>0?e=>e&&[a(p),h(e)]:n<0?e=>!e&&[a(p),h(i(r-1))]:n:n=>{n=[e,h(n)];do{t+=p,n.push(h(i(r)))}while(o.space()==u&&(p<2||f(p)==e)&&(!d||l(p)<=32));return n},c[u]=(t,n)=>n<r&&(p<2||f(p)==e)&&(!d||l(p)<=32)&&s(t)||y&&y(t,n));const h=e=>Array.isArray(e)?e:(e||s()).valueOf();o.token.push((e=>(e=a((e=>e>47&&e<58||46==e)))&&((69==l()||101==l())&&(e+=a(2)+a((e=>e>=48&&e<=57))),isNaN(e=new Number(e))?s("Bad number"):e)),((e,r,t,n)=>{if(34===e||39===e){for(r=f(),a(),n="";(t=l())-e;)92===t?(a(),n+=y[f()]||f()):n+=f(),a();return a(),r+n+r}}),(e=>a((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e))));const y={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"};o.space=e=>{for(;(e=l())<=32||47===e;)if(e<=32)a();else if(47===e)if(42===l(1))a(2),a((e=>42!==e&&47!==l(1))),a(2);else{if(47!==l(1))break;a(2),a((e=>e>=32))}return e};const d=(e,r=2,t)=>{for(let n=0;n<t.length;n+=r)e(t[n],t[n+1],t[n+2])};d(o.operator,3,[",",1,,"|",6,,"||",4,,"&",8,,"&&",5,,"^",7,,"==",9,,"!=",9,,">",10,,">=",10,,">>",11,,">>>",11,,"<",10,,"<=",10,,"<<",11,,"+",12,,"+",15,-1,"++",15,-1,"++",15,1,"-",12,,"-",15,-1,"--",15,-1,"--",15,1,"!",15,-1,"*",13,,"/",13,,"%",13,,".",18,(e,r)=>e&&[a(),e,"string"==typeof(r=i(18))?'"'+r+'"':r.valueOf()],"[",18,e=>(a(),[".",e,h(i(0,93))]),"]",,,"(",18,(e,r)=>(a(),r=i(0,41),Array.isArray(r)&&","===r[0]?(r[0]=e,r):r?[e,h(r)]:[e]),"(",19,(e,r)=>!e&&(a(),i(0,41)||s()),")",,,";",1,,"===",9,,"!==",9,,"**",14,,"~",15,-1,"?",3,e=>{let r;return e||s("Expected expression"),a(),o.space(),r=i(),["?:",e,r[1],r[2]]},"}",,,":",2,,"in",10,e=>l(2)<=32&&[a(2),'"'+e+'"',i(10)],"[",20,(e,r)=>!e&&(a(),(r=i(0,93))?","==r[0]?(r[0]="[",r):["[",r]:["["]),"{",20,(e,r)=>!e&&(a(),(r=i(0,125))?":"==r[0]?["{",r]:","==r[0]?(r[0]="{",r):["{",r]:["{"]),"null",20,e=>!e&&(a(4),g(null)),"false",20,e=>!e&&(a(5),g(!1)),"true",20,e=>!e&&(a(4),g(!0)),"undefined",20,e=>!e&&(a(9),g(void 0))]);const g=e=>({valueOf:()=>e});d(e.operator,2,["!",e=>!e,"++",e=>++e,"--",e=>--e,".",(e,r)=>e?e[r]:e,"%",(e,r)=>e%r,"/",(e,r)=>e/r,"*",(e,r)=>e*r,"+",(e,r=0)=>e+r,"-",(e,r)=>null==r?-e:e-r,">>>",(e,r)=>e>>>r,">>",(e,r)=>e>>r,"<<",(e,r)=>e<<r,">=",(e,r)=>e>=r,">",(e,r)=>e>r,"<=",(e,r)=>e<=r,"<",(e,r)=>e<r,"!=",(e,r)=>e!=r,"==",(e,r)=>e==r,"&",(e,r)=>e&r,"^",(e,r)=>e^r,"|",(e,r)=>e|r,"&&",(...e)=>e.every(Boolean),"||",(...e)=>e.some(Boolean),",",(e,r)=>r,"**",(...e)=>e.reduceRight(((e,r)=>Math.pow(r,e))),"~",e=>~e,"?:",(e,r,t)=>e?r:t,"in",(e,r)=>e in r,"[",(...e)=>Array(...e),"{",(...e)=>Object.fromEntries(e),":",(e,r)=>[e,r]]);var A=r=>(r="string"==typeof r?o(r):r,t=>e(r,t));export{A as default,e as evaluate,o as parse};