var e,r,l,t=()=>r.charCodeAt(e),n=(l=1)=>r.substr(e,l),a=r=>{throw Error(r+" at "+e)},o=(l,n=e,o)=>{if("number"==typeof l)e+=l;else for(;l(t());)++e>r.length&&a("Unexpected end "+l);return e>n?r.slice(n,e):null},i=()=>{for(;t()<=32;)e++},s=(e,r=c.map[e[0]])=>r?r(e):e,u=(r,t,a,o=3)=>{if(e&&l&&l[3]===e)return l;for(;o;)if(null!=(a=r[t=n(o--)]))return l=[t,a,t.length,e]},f=(r,l=-1)=>{i();let a,o,y=t();if(n(),c.token.find((e=>null!=(o=e()))),null==o)(a=u(c.prefix))&&(e+=a[2],o=s([a[0],f(r,a[1])]));else if("string"==typeof o&&c.literal.hasOwnProperty(o))o=c.literal[o];else for(i();y=t(),46===y||40===y||91===y;)e++,46===y?(i(),o=s([".",o,p()])):91===y?(o=s(["[",o,f(93)]),e++):40===y&&(o=s(["(",o,f(41)]),e++),i();for(i();(y=t())&&y!==r&&(a=u(c.binary))&&a[1]>l;){o=[a[0],o];do{e+=a[2],o.push(f(r,a[1]))}while(n(a[2])===a[0]);o=s(o),i()}return o},p=()=>o((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192)),c=Object.assign((t=>(r=t,e=l=0,f())),{token:[(r=40,l=41,n)=>t()===r?(e++,n=f(l),e++,n):null,(r,l,a)=>{if(r=o(a=e=>e>=48&&e<=57)||"",46===t()&&(e++,r+="."+o(a)),r)return(69===(l=t())||101===l)&&(e++,r+="e",(43===(l=t())||45===l)&&(r+=n(),e++),r+=o(a)),parseFloat(r)},(r=t(),l)=>34===r||39===r?(l=n(),e++,l+o((e=>e!==r))+(e++,l)):null,p],literal:{true:!0,false:!1,null:null},prefix:{"-":10,"!":10,"+":10,"++":10,"--":10},postfix:{"++":10,"--":10},binary:{",":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},map:{".":([e,r,l])=>[e,r,'"'+l+'"'],"[":e=>(e[0]=".",e),"(":([e,r,l])=>Array.isArray(l)&&","===l[0]?(l[0]=r,l):null==l?[r]:[r,l]}}),y=c,d=e=>Array.isArray(e)&&("string"==typeof e[0]||d(e[0])),g=Object.assign(((e,r={},l,t)=>d(e)?("string"==typeof(l=e[0])&&(t=g.operator[l]),"function"!=typeof(l=t||g(l,r))?l:l.call(...e.map((e=>g(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e),{operator:{"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))}}),h=g,b=e=>(e="string"==typeof e?y(e):e,r=>h(e,r));export{b as default,h as evaluate,y as parse};
