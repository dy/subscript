let e,r,t=t=>(e=0,r=t,t=l(),r[e]?n():t||""),n=(t="Bad syntax",n=r.slice(0,e).split("\n"),a=n.pop())=>{let l=r.slice(e-108,e).split("\n").pop(),s=r.slice(e,e+108).split("\n").shift();throw EvalError(`${t} at ${n.length}:${a.length} \`${l+s}\``,"font-weight: bold")},a=(t=1,n=e,a)=>{if("number"==typeof t)e+=t;else for(;a=t(r.charCodeAt(e));)e+=a;return r.slice(n,e)},l=(r=0,a,l,s,i,o)=>{for(;(l=t.space())&&(i=((o=p[l])&&o(s,r))??(!s&&t.id()));)s=i;return a&&(l==a?e++:n()),s},s=e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e,i=t.space=t=>{for(;(t=r.charCodeAt(e))<=32;)e++;return t},o=t.id=e=>a(s),p=[],h=(t,n=32,a,l=t.charCodeAt(0),i=t.length,o=p[l],h=t.toUpperCase()!==t)=>p[l]=(l,p,c=e)=>p<n&&(i<2||r.substr(e,i)==t)&&(!h||!s(r.charCodeAt(e+i)))&&(e+=i,a(l,p))||(e=c,o?.(l,p)),c=(e,r,t=0)=>h(e,r,((n,a)=>n&&(a=l(r-t/2))&&[e,n,a])),d=(e,r,t)=>h(e,r,(n=>t?n&&[e,n]:!n&&(n=l(r-.5))&&[e,n])),f=(e,r,t)=>{h(e,r,((n,a)=>(n||t)&&((a=l(r))||t)&&((!n||n[0]!==e)&&(n=[e,n]),(a||t)&&n.push(a),n)))};const g=e=>Array.isArray(e)?e[0]?u[e[0]](...e.slice(1)):()=>e[1]:r=>r?.[e],u={},m=(e,r,t=u[e])=>u[e]=(...e)=>r(...e)||t&&t(...e),b=(e,r,t)=>"()"===e[0]?b(e[1],r,t):"string"==typeof e?r.bind(0,(e=>e),(()=>e)):"."===e[0]?r.bind(0,g(e[1]),(e=e[2],()=>e)):"["===e[0]?r.bind(0,g(e[1]),g(e[2])):t?(e=g(e),r.bind(0,(r=>[e(r)]),(()=>0))):()=>n("Bad left value"),A=(e,r,t)=>t.length?t.length>1?(c(e,Math.abs(r),r<0),m(e,((e,r)=>r&&(e=g(e),r=g(r),e.length||r.length?n=>t(e(n),r(n)):(e=t(e(),r()),()=>e))))):(d(e,r),m(e,((e,r)=>!r&&((e=g(e)).length?r=>t(e(r)):(e=t(e()),()=>e))))):(f(e,Math.abs(r),r<0),m(e,((...e)=>(e=e.map(g),r=>t(...e.map((e=>e(r))))))));var y=e=>g(t(e));const C=e=>e?n():[,(e=+a((e=>46===e||e>=48&&e<=57||(69===e||101===e?2:0))))!=e?n():e];p[46]=e=>!e&&C();for(let e=48;e<=57;e++)p[e]=C;const v={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},E=t=>(l,s,i="")=>{for(l&&n("Unexpected string"),a();(s=r.charCodeAt(e))-t;)92===s?(a(),s=a(),i+=v[s]||s):i+=a();return a()||n("Bad string"),[,i]};p[34]=E(34),p[39]=E(39),h("(",17,((e,r)=>e&&((r=l(0,41))?["(",e,r]:["(",e,""]))),m("(",((e,r,t)=>(t=""==r?()=>[]:","===r[0]?(r=r.slice(1).map(g),e=>r.map((r=>r(e)))):(r=g(r),e=>[r(e)]),b(e,((e,r,n)=>e(n)[r(n)](...t(n))),!0)))),h("[",17,(e=>e&&["[",e,l(0,93)||n()])),m("[",((e,r)=>r&&(e=g(e),r=g(r),t=>e(t)[r(t)]))),h(".",17,((e,r)=>e&&(r=l(17))&&[".",e,r])),m(".",((e,r)=>(e=g(e),r=r[0]?r:r[1],t=>e(t)[r]))),h("(",17,(e=>!e&&["()",l(0,41)||n("Empty group")])),m("()",(e=>g(e))),A(",",1,((...e)=>e[e.length-1])),A(";",-1,((...e)=>e[e.length-1])),A("*",12,((e,r)=>e*r)),A("/",12,((e,r)=>e/r)),A("%",12,((e,r)=>e%r)),c("*=",2,!0),m("*=",((e,r)=>(r=g(r),b(e,((e,t,n)=>e(n)[t(n)]*=r(n)))))),c("/=",2,!0),m("/=",((e,r)=>(r=g(r),b(e,((e,t,n)=>e(n)[t(n)]/=r(n)))))),c("%=",2,!0),m("%=",((e,r)=>(r=g(r),b(e,((e,t,n)=>e(n)[t(n)]%=r(n)))))),A("+",14,(e=>+e)),A("-",14,(e=>-e)),A("+",11,((e,r)=>e+r)),A("-",11,((e,r)=>e-r)),c("+=",2,!0),m("+=",((e,r)=>(r=g(r),b(e,((e,t,n)=>e(n)[t(n)]+=r(n)))))),c("-=",2,!0),m("-=",((e,r)=>(r=g(r),b(e,((e,t,n)=>e(n)[t(n)]-=r(n)))))),h("++",15,(e=>e?["-",["++",e],[,1]]:["++",l(14)])),m("++",(e=>b(e,((e,r,t)=>++e(t)[r(t)])))),h("--",15,(e=>e?["+",["--",e],[,1]]:["--",l(14)])),m("--",(e=>b(e,((e,r,t)=>--e(t)[r(t)])))),A("~",14,(e=>~e)),A("|",5,((e,r)=>e|r)),A("&",7,((e,r)=>e&r)),A("^",6,((e,r)=>e^r)),A(">>",10,((e,r)=>e>>r)),A("<<",10,((e,r)=>e<<r)),A("==",8,((e,r)=>e==r)),A("!=",8,((e,r)=>e!=r)),A(">",8,((e,r)=>e>r)),A(">=",8,((e,r)=>e>=r)),A("<",8,((e,r)=>e<r)),A("<=",8,((e,r)=>e<=r)),A("!",14,(e=>!e)),A("||",3,((...e)=>{let r,t=0;for(;!r&&t<e.length;)r=e[t++];return r})),A("&&",4,((...e)=>{let r=0,t=!0;for(;t&&r<e.length;)t=e[r++];return t})),c("=",2,!0),m("=",((e,r)=>(r=g(r),b(e,((e,t,n)=>e(n)[t(n)]=r(n)))))),h("/*",20,((t,n)=>(a((t=>42!==t&&47!==r.charCodeAt(e+1))),a(2),t||l(n)||[""]))),h("//",20,((e,r)=>(a((e=>e>=32)),e||l(r)||[""]))),h("?",2,((e,r,t)=>e&&(r=l(2,58))&&["?",e,r,l(3)])),m("?",((e,r,t)=>(e=g(e),r=g(r),t=g(t),n=>e(n)?r(n):t(n)))),h("true",20,(e=>e?err():[,!0])),h("false",20,(e=>e?err():[,!1])),h("[",20,(e=>!e&&["[",l(0,93)||""])),m("[",((e,r)=>!r&&(e?","===e[0]?(e=e.slice(1).map(g),r=>e.map((e=>e(r)))):(e=g(e),r=>[e(r)]):()=>[]))),h("{",20,(e=>!e&&["{",l(0,125)||""])),m("{",((e,r)=>e?","===e[0]?(e=e.slice(1).map(g),r=>Object.fromEntries(e.map((e=>e(r))))):":"===e[0]?(e=g(e),r=>Object.fromEntries([e(r)])):(r=g(e),t=>({[e]:r(t)})):e=>({}))),h(":",1.1,((e,r)=>[":",e,l(1.1)||err()])),m(":",((e,r)=>(r=g(r),e=Array.isArray(e)?g(e):(e=>e).bind(0,e),t=>[e(t),r(t)]))),A("??",5,((e,r)=>e??r)),h("?.",17,(e=>e&&["?.",e])),m("?.",(e=>(e=g(e),r=>e(r)||(()=>{})))),h("?.",17,((e,r)=>e&&!(r=l(17))?.map&&["?.",e,r])),m("?.",((e,r)=>r&&(e=g(e),t=>e(t)?.[r]))),m("(",((e,r,t,n,a,l)=>null!=r&&"?."===e[0]&&(e[2]||Array.isArray(e[1]))&&(n=""==r?()=>[]:","===r[0]?(r=r.slice(1).map(g),e=>r.map((r=>r(e)))):(r=g(r),e=>[r(e)]),!e[2]&&(e=e[1]),a="["===e[0]?g(e[2]):()=>e[2],t=g(e[1]),e=>t(e)?.[a(e)]?.(...n(e))))),A("in",9,((e,r)=>e in r)),h("null",20,(e=>e?n():[,null])),A("**",-13,((e,r)=>e**r));export{b as access,c as binary,g as compile,r as cur,y as default,n as err,l as expr,o as id,e as idx,s as isId,p as lookup,f as nary,m as operator,u as operators,t as parse,A as set,a as skip,i as space,h as token,d as unary};