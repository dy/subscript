var e,r,a=(a,o)=>(r=a,e=0,o=p(),e<r.length?t():o),t=(a="Bad syntax")=>{throw Error(a+" `"+r[e]+"` at "+e)},o=(a=1,t=e)=>{if("number"==typeof a)e+=a;else for(;a(n());)e++;return r.slice(t,e)||s},n=(a=0)=>r.charCodeAt(e+a),s="",p=(r=0,o,p=a.space(),c,i=e,u=0,l)=>{for(;i===e&&u<a.token.length;)c=a.token[u++](p);for(u=Math.max(0|f[p=a.space()],r);u<a.operator.length&&!(p===o||u<r);)(l=a.operator[u++](c,p,u,o))&&(l.indexOf(s)>=0&&t("Bad expression"),c=l,u=Math.max(0|f[p=a.space()],r));return!r&&o&&n()!=o&&t("Unclosed paren"),c},c=e=>(r,t,n,c,f,i)=>{if(r!==s&&(i=0|e(t))){for(f=[o(i),r,p(n,c)];a.space()===t;)o(i),f.push(p(n,c));return f}},f=[];f[44]=0,f[124]=1,f[38]=2,f[94]=4,f[61]=f[33]=6,f[60]=f[62]=7,f[43]=f[45]=9,f[42]=f[47]=f[37]=10,f[46]=f[91]=f[40]=13,a.space=r=>{for(;(r=n())<=32;)e++;return r},a.token=[e=>(e=o((e=>e>47&&e<58||46===e)))?((69===n()||101===n())&&(e+=o(2)+o((e=>e>=48&&e<=57))),isNaN(e=parseFloat(e))?t("Bad number"):e):s,(e,r)=>34===e?o()+o((r=>r-e))+o():s,r=>40===r?(++e,r=p(0,41),++e,r===s?t():r):s,e=>o((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e))],a.operator=[c((e=>44==e)),c((e=>124==e&&n(1)==e&&2)),c((e=>38==e&&n(1)==e&&2)),c((e=>124==e)),c((e=>94==e)),c((e=>38==e)),c((e=>(61==e||33==e)&&61==n(1)&&(n(1)==n(2)?3:2))),c((e=>(62==e||60==e)&&e!=n(1))),c((e=>(60==e||62==e)&&e==n(1)&&(e==n(2)?3:2))),c((e=>(43==e||45==e)&&n(1)!=e)),c((e=>42==e&&42!=n(1)||47==e||37==e)),(e,r,a,t)=>(43==r||45==r)&&n(1)==r&&[o(2),e===s?p(a-1,t):e],(e,r,a,t)=>(43==r||45==r||33==r)&&e===s&&[o(),p(a-1,t)],(r,a,t,n,c)=>46==a?[o(),r,"string"==typeof(c=p(t,n))?'"'+c+'"':c]:91==a?(e++,r=[".",r,p(0,93)],e++,r):40==a?(e++,c=p(0,41),e++,Array.isArray(c)&&","===c[0]?(c[0]=r,c):c===s?[r]:[r,c]):s];var i=a,u=e=>Array.isArray(e)&&("string"==typeof e[0]||u(e[0])),l=(e,r={},a,t)=>u(e)?("string"==typeof(a=e[0])&&(t=d[a]),"function"!=typeof(a=t||l(a,r))?a:a.call(...e.map((e=>l(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e,d=l.operator={"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))},y=l,g=e=>(e="string"==typeof e?i(e):e,r=>y(e,r));export{g as default,y as evaluate,i as parse};