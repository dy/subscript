var e,r,t,l=l=>(r=l,e=t=0,a()),n=()=>{for(;s()<=32;)e++},o=(r,l,n,o=3)=>{if(e&&t&&t[3]===e)return t;for(;o;)if(null!=(n=r[l=f(o--)]))return t=[l,n,l.length,e]},a=(r,t=-1)=>{n();let l,u,i,c=s(),d=0,A=e;if(c!==r){for(;A===e&&d<p.length;)u=p[d++](c);if(A===e)(l=o(h))&&(e+=l[2],u=[l[0],a(r,l[1])]);else{if(n(),c=s(),c===r)return u;for(d=0;d<y.length;)(i=y[d](u,c))!==u?(u=i,d=0,n(),c=s()):d++}for(n();(c=s())&&c!==r&&(l=o(g))&&l[1]>t;){u=[l[0],u];do{e+=l[2],u.push(a(r,l[1]))}while(f(l[2])===l[0]);n()}return u}},u=e=>(e=c((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192)))&&d.hasOwnProperty(e)?d[e]:e,s=()=>r.charCodeAt(e),f=(t=1)=>r.substr(e,t),i=r=>{throw Error(r+" at "+e)},c=(t=1,l=e)=>{if("number"==typeof t)e+=t;else for(;t(s());)++e>r.length&&i("Unexpected end "+t);return e>l?r.slice(l,e):null},p=l.token=[(r,t)=>40===r?(e++,t=a(41),e++,t):null,e=>{if(e=c((e=>e>=48&&e<=57||46===e)))return(69===s()||101===s())&&(e+=c(2)+c((e=>e>=48&&e<=57))),isNaN(e=parseFloat(e))?i("Bad number"):e},(r,t)=>34===r?(t=f(),e++,t+c((e=>e!==r))+(e++,t)):null,u],d=l.literal={true:!0,false:!1,null:null},y=l.postfix=[(r,t,l)=>(46===t?(e++,n(),r=[".",r,'"'+u()+'"']):91===t?(e++,r=[".",r,a(93)],e++):40===t&&(e++,l=a(41),r=Array.isArray(l)&&","===l[0]?(l[0]=r,l):null==l?[r]:[r,l],e++),r),(t,l)=>43!==l&&45!==l||r.charCodeAt(e+1)!==l?t:[c(2),t]],h=l.unary={"-":17,"!":17,"+":17,"++":17,"--":17},g=l.binary={",":1,"||":6,"&&":7,"|":8,"^":9,"&":10,"==":11,"!=":11,"<":12,">":12,"<=":12,">=":12,"<<":13,">>":13,">>>":13,"+":14,"-":14,"*":15,"/":15,"%":15},A=l,b=e=>Array.isArray(e)&&("string"==typeof e[0]||b(e[0])),m=(e,r={},t,l)=>b(e)?("string"==typeof(t=e[0])&&(l=v[t]),"function"!=typeof(t=l||m(t,r))?t:t.call(...e.map((e=>m(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e,v=m.operator={"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))},w=m,x=e=>(e="string"==typeof e?A(e):e,r=>w(e,r));export{x as default,w as evaluate,A as parse};