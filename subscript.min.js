let e,t,l=l=>(e=0,t=l,l=n(),t[e]?r():l||""),r=(l="Bad syntax",r=t[e],a=t.slice(0,e).split("\n"),n=a.pop())=>{let s=t.slice(e-108,e).split("\n").pop(),h=t.slice(e+1,e+108).split("\n").shift();throw EvalError(`${l} at ${a.length}:${n.length} \`${s+r+h}\``,"font-weight: bold")},a=(l=1,r=e,a)=>{if("number"==typeof l)e+=l;else for(;a=l(t.charCodeAt(e));)e+=a;return t.slice(r,e)},n=(t=0,a,n,s,h,o)=>{for(;(n=l.space())&&(h=((o=p[n])&&o(s,t))??(!s&&l.id()));)s=h;return a&&(n==a?e++:r()),s},s=e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e,h=l.space=l=>{for(;(l=t.charCodeAt(e))<=32;)e++;return l},o=l.id=e=>a(s),p=[],i=(l,r=32,a,n=l.charCodeAt(0),h=l.length,o=p[n],i=l.toUpperCase()!==l)=>p[n]=(n,p,c=e)=>p<r&&(h<2||t.substr(e,h)==l)&&(!i||!s(t.charCodeAt(e+h)))&&(e+=h,a(n,p))||(e=c,o?.(n,p)),c=(e,t,l=0)=>i(e,t,((r,a)=>r&&(a=n(t-l/2))&&[e,r,a])),g=(e,t,l)=>i(e,t,(r=>l?r&&[e,r]:!r&&(r=n(t-.5))&&[e,r])),f=(e,t,l)=>{i(e,t,((r,a)=>(r||l)&&((a=n(t))||l)&&((!r||r[0]!==e)&&(r=[e,r]),(a||l)&&r.push(a),r)))};const u=e=>Array.isArray(e)?d[e[0]](...e.slice(1)):t=>t?.[e],d={},A=(e,t,l=d[e])=>d[e]=(...e)=>t(...e)||l&&l(...e),b=e=>(e=l(e),t=>(e.call?e:e=u(e))(t)),m=(e,t,l)=>l.length?l.length>1?(c(e,Math.abs(t),t<0),A(e,((e,t)=>t&&(e=u(e),t=u(t),e.length||t.length?r=>l(e(r),t(r)):(e=l(e(),t()),()=>e))))):(g(e,t),A(e,((e,t)=>!t&&((e=u(e)).length?t=>l(e(t)):(e=l(e()),()=>e))))):(f(e,Math.abs(t),t<0),A(e,((...e)=>(e=e.map(u),t=>l(...e.map((e=>e(t)))))))),y=e=>e?r():["",(e=+a((e=>46===e||e>=48&&e<=57||(69===e||101===e?2:0))))!=e?r():e],C=(e,t,l,r)=>(i(e,t,(l=>l?["++"===e?"-":"+",[e,l],["",1]]:[e,n(t-1)])),A(e,r=(e,t)=>"("===e[0]?r(e[1]):"."===e[0]?(t=e[2],e=u(e[1]),r=>l(e(r),t)):"["===e[0]?([,e,t]=e,e=u(e),t=u(t),r=>l(e(r),t(r))):t=>l(t,e)));A("",(e=>()=>e)),p[34]=e=>e?r():["",(a()+a((e=>e-34?1:0))+(a()||r("Bad string"))).slice(1,-1)],p[46]=e=>!e&&y();for(let e=0;e<=9;e++)p[48+e]=y;m(",",1,((...e)=>e[e.length-1])),m("||",4,((...e)=>{let t,l=0;for(;!t&&l<e.length;)t=e[l++];return t})),m("&&",5,((...e)=>{let t=0,l=!0;for(;l&&t<e.length;)l=e[t++];return l})),c("=",10,!0),A("=",((e,t)=>{let l,a,n=u(t),s="string"==typeof e?(t,l)=>t[e]=l:"."===e[0]?(l=u(e[1]),a=e[2],(e,t)=>l(e)[a]=t):"["===e[0]?(l=u(e[1]),a=u(e[2]),(e,t)=>l(e)[a(e)]=t):r("Bad left value");return e=>s(e,n(e))})),m("+",12,((e,t)=>e+t)),m("-",12,((e,t)=>e-t)),m("*",13,((e,t)=>e*t)),m("/",13,((e,t)=>e/t)),m("%",13,((e,t)=>e%t)),m("|",6,((e,t)=>e|t)),m("&",8,((e,t)=>e&t)),m("^",7,((e,t)=>e^t)),m("==",9,((e,t)=>e==t)),m("!=",9,((e,t)=>e!=t)),m(">",10,((e,t)=>e>t)),m(">=",10,((e,t)=>e>=t)),m("<",10,((e,t)=>e<t)),m("<=",10,((e,t)=>e<=t)),m(">>",11,((e,t)=>e>>t)),m(">>>",11,((e,t)=>e>>>t)),m("<<",11,((e,t)=>e<<t)),m("+",15,(e=>+e)),m("-",15,(e=>-e)),m("!",15,(e=>!e)),C("++",15,((e,t)=>++e[t])),C("--",15,((e,t)=>--e[t])),i("[",18,(e=>e&&["[",e,n(0,93)||r()])),A("[",((e,t)=>t&&(e=u(e),t=u(t),l=>e(l)[t(l)]))),i(".",18,((e,t)=>e&&(t=n(18))&&[".",e,t])),A(".",((e,t)=>(e=u(e),t=t[0]?t:t[1],l=>e(l)[t]))),i("(",18,(e=>!e&&["(",n(0,41)||r()])),i("(",18,((e,t)=>e&&((t=n(0,41))?["(",e,t]:["(",e,""]))),A("(",((e,t,l,r,a)=>null==t?u(e):(a=""==t?()=>[]:","===t[0]?(t=t.slice(1).map(u),e=>t.map((t=>t(e)))):(t=u(t),e=>[t(e)]),"."===e[0]?(l=e[2],e=u(e[1]),t=>e(t)[l](...a(t))):"["===e[0]?(l=u(e[2]),e=u(e[1]),t=>e(t)[l(t)](...a(t))):(e=u(e),t=>e(t)(...a(t))))));export{c as binary,u as compile,t as cur,b as default,r as err,n as expr,o as id,e as idx,s as isId,p as lookup,f as nary,A as operator,d as operators,l as parse,m as set,a as skip,h as space,i as token,g as unary};