let t,e,r=r=>(t=0,e=r,r=a(),e[t]?l():r||""),l=(r="Bad syntax",l=e[t],n=e.slice(0,t).split("\n"),a=n.pop())=>{let s=e.slice(t-108,t).split("\n").pop(),h=e.slice(t+1,t+108).split("\n").shift();throw EvalError(`${r} at ${n.length}:${a.length} \`${s+l+h}\``,"font-weight: bold")},n=(r=1,l=t,n)=>{if("number"==typeof r)t+=r;else for(;n=r(e.charCodeAt(t));)t+=n;return e.slice(l,t)},a=(e=0,n,a,s,h,o)=>{for(;(a=r.space())&&(h=((o=p[a])&&o(s,e))??(!s&&r.id()));)s=h;return n&&(a==n?t++:l()),s},s=t=>t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||36==t||95==t||t>=192&&215!=t&&247!=t,h=r.space=r=>{for(;(r=e.charCodeAt(t))<=32;)t++;return r},o=r.id=t=>n(s),p=[],i=(r,l=32,n,a=r.charCodeAt(0),h=r.length,o=p[a],i=r.toUpperCase()!==r)=>p[a]=(a,p,c=t)=>p<l&&(h<2||e.substr(t,h)==r)&&(!i||!s(e.charCodeAt(t+h)))&&(t+=h,n(a,p))||(t=c,o?.(a,p)),c=(t,e,r=0)=>i(t,e,((l,n)=>l&&(n=a(e-r/2))&&[t,l,n])),g=(t,e,r)=>i(t,e,(l=>r?l&&[t,l]:!l&&(l=a(e-.5))&&[t,l])),f=(t,e,r)=>{i(t,e,((l,n)=>(l||r)&&((n=a(e))||r)&&((!l||l[0]!==t)&&(l=[t,l]),(n||r)&&l.push(n),l)))};const d=t=>Array.isArray(t)?u[t[0]](...t.slice(1)):e=>e?.[t],u={},A=(t,e,r=u[t])=>u[t]=(...t)=>e(...t)||r&&r(...t),b=t=>(t=r(t),e=>(t.call?t:t=d(t))(e)),m=(t,e,r)=>r.length?r.length>1?(c(t,Math.abs(e),e<0),A(t,((t,e)=>e&&(t=d(t),e=d(e),t.length||e.length?l=>r(t(l),e(l)):(t=r(t(),e()),()=>t))))):(g(t,e),A(t,((t,e)=>!e&&((t=d(t)).length?e=>r(t(e)):(t=r(t()),()=>t))))):(f(t,Math.abs(e),e<0),A(t,((...t)=>(t=t.map(d),e=>r(...t.map((t=>t(e)))))))),y=t=>t?l():["",(t=+n((t=>46===t||t>=48&&t<=57||(69===t||101===t?2:0))))!=t?l():t],C=(t,e,r,l)=>(i(t,e,(r=>r?["++"===t?"-":"+",[t,r],["",1]]:[t,a(e-1)])),A(t,l=(t,e)=>"("===t[0]?l(t[1]):"."===t[0]?(e=t[2],t=d(t[1]),l=>r(t(l),e)):"["===t[0]?([,t,e]=t,t=d(t),e=d(e),l=>r(t(l),e(l))):e=>r(e,t)));A("",(t=>()=>t)),p[34]=t=>t?l():["",(n()+n((t=>t-34?1:0))+(n()||l("Bad string"))).slice(1,-1)],p[46]=t=>!t&&y();for(let t=0;t<=9;t++)p[48+t]=y;m(",",1,((...t)=>t[t.length-1])),m("||",4,((...t)=>{let e,r=0;for(;!e&&r<t.length;)e=t[r++];return e})),m("&&",5,((...t)=>{let e=0,r=!0;for(;r&&e<t.length;)r=t[e++];return r})),c("=",10,!0),A("=",((t,e)=>{let r,n,a=d(e),s="string"==typeof t?(e,r)=>e[t]=r:"."===t[0]?(r=d(t[1]),n=t[2],(t,e)=>r(t)[n]=e):"["===t[0]?(r=d(t[1]),n=d(t[2]),(t,e)=>r(t)[n(t)]=e):l("Bad LHS");return t=>s(t,a(t))})),m("+",12,((t,e)=>t+e)),m("-",12,((t,e)=>t-e)),m("*",13,((t,e)=>t*e)),m("/",13,((t,e)=>t/e)),m("%",13,((t,e)=>t%e)),m("|",6,((t,e)=>t|e)),m("&",8,((t,e)=>t&e)),m("^",7,((t,e)=>t^e)),m("==",9,((t,e)=>t==e)),m("!=",9,((t,e)=>t!=e)),m(">",10,((t,e)=>t>e)),m(">=",10,((t,e)=>t>=e)),m("<",10,((t,e)=>t<e)),m("<=",10,((t,e)=>t<=e)),m(">>",11,((t,e)=>t>>e)),m(">>>",11,((t,e)=>t>>>e)),m("<<",11,((t,e)=>t<<e)),m("+",15,(t=>+t)),m("-",15,(t=>-t)),m("!",15,(t=>!t)),C("++",15,((t,e)=>++t[e])),C("--",15,((t,e)=>--t[e])),i("[",18,(t=>t&&["[",t,a(0,93)||l()])),A("[",((t,e)=>e&&(t=d(t),e=d(e),r=>t(r)[e(r)]))),i(".",18,((t,e)=>t&&(e=a(18))&&[".",t,e])),A(".",((t,e)=>(t=d(t),e=e[0]?e:e[1],r=>t(r)[e]))),i("(",18,(t=>!t&&["(",a(0,41)||l()])),i("(",18,((t,e)=>t&&((e=a(0,41))?["(",t,e]:["(",t,""]))),A("(",((t,e,r,l,n)=>null==e?d(t):(n=""==e?()=>[]:","===e[0]?(e=e.slice(1).map(d),t=>e.map((e=>e(t)))):(e=d(e),t=>[e(t)]),"."===t[0]?(r=t[2],t=d(t[1]),e=>t(e)[r](...n(e))):"["===t[0]?(r=d(t[2]),t=d(t[1]),e=>t(e)[r(e)](...n(e))):(t=d(t),e=>t(e)(...n(e))))));export{c as binary,d as compile,e as cur,b as default,l as err,a as expr,o as id,t as idx,s as isId,p as lookup,f as nary,A as operator,u as operators,r as parse,m as set,n as skip,h as space,i as token,g as unary};