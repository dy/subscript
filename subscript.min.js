var e,r,a=(a,n)=>(r=a,e=0,n=u(),e<r.length?t():n),t=(a="Bad syntax "+r[e])=>{throw Error(a+" at "+e)},n=e=>null==e&&t("Bad expression"),l=(a=1,t=e)=>{if("number"==typeof a)e+=a;else for(;a(o());)e++;return r.slice(t,e)||null},o=(a=0)=>r.charCodeAt(e+a),s=(a=1)=>r.substr(e,a),u=(r=0,n,l=a.space(),s,u=e,p=0,i)=>{for(;u===e&&p<a.token.length;)s=a.token[p++](l);for(p=Math.max(0|c[l=a.space()],r);p<a.operator.length&&!(l===n||p<r);)(i=a.operator[p++](s,l,p,n))&&(s=i,p=Math.max(0|c[l=a.space()],r));return!r&&n&&o()!=n&&t("Unclosed paren"),s};a.space=r=>{for(;(r=o())<=32;)e++;return r},a.token=[e=>{if(e=l((e=>e>47&&e<58||46===e)))return(69===o()||101===o())&&(e+=l(2)+l((e=>e>=48&&e<=57))),isNaN(e=parseFloat(e))?t("Bad number"):e},(e,r)=>34===e?l()+l((r=>r-e))+l():null,(r,a)=>40===r?(e++,a=u(0,41),n(a),e++,a):null,e=>l((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e))],a.operator=[(e,r,a,t)=>44==r&&p(s(),e,a,t),(e,r,a,t)=>124==r&&o(1)==r&&p(s(2),e,a,t),(e,r,a,t)=>38==r&&o(1)==r&&p(s(2),e,a,t),(e,r,a,t)=>124==r&&p(s(),e,a,t),(e,r,a,t)=>94==r&&p(s(),e,a,t),(e,r,a,t)=>38==r&&p(s(),e,a,t),(e,r,a,t)=>(61==r||33==r)&&61==o(1)&&p(s(2),e,a,t),(e,r,a,t)=>(62==r||60==r)&&r!=o(1)&&p(s(),e,a,t),(e,r,a,t)=>(60==r||62==r)&&r==o(1)&&p(s(r==o(2)?3:2),e,a,t),(e,r,a,t)=>(43==r||45==r)&&null!=e&&o(1)!=r&&p(s(),e,a,t),(e,r,a,t)=>(42==r&&42!=o(1)||47==r||37==r)&&p(s(),e,a,t),(e,r,a,t)=>(43==r||45==r)&&o(1)==r&&p(l(2),e??u(a-1,t)),(e,r,a,t)=>(43==r||45==r||33==r)&&null==e&&p(l(),u(a-1,t)),(r,a,t,n,o)=>46==a?[l(),r,'"'+u(t,n)+'"']:91==a?(e++,r=[".",r,u(0,93)],e++,r):40==a?(e++,o=u(0,41),e++,Array.isArray(o)&&","===o[0]?(o[0]=r,o):null==o?[r]:[r,o]):null];var p=(e,r,t,p,c=[e,r],i=o())=>{if(n(r),null!=t)do{l(e.length),c.push(r=u(t,p)),n(r)}while(a.space()==i&&s(e.length)==e);return c},c=[];c[44]=0,c[124]=1,c[38]=2,c[94]=4,c[61]=c[33]=6,c[60]=c[62]=7,c[43]=c[45]=9,c[42]=c[47]=c[37]=10,c[46]=c[91]=c[40]=13;var i=a,f=e=>Array.isArray(e)&&("string"==typeof e[0]||f(e[0])),d=(e,r={},a,t)=>f(e)?("string"==typeof(a=e[0])&&(t=h[a]),"function"!=typeof(a=t||d(a,r))?a:a.call(...e.map((e=>d(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e,h=d.operator={"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))},y=d,g=e=>(e="string"==typeof e?i(e):e,r=>y(e,r));export{g as default,y as evaluate,i as parse};