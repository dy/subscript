var e,r,a=(a,o)=>(r=a,e=0,o=c(),e<r.length?t():o),t=(a="Bad syntax")=>{throw Error(a+" `"+r[e]+"` at "+e)},o=(a=1,t=e)=>{if("number"==typeof a)e+=a;else for(;a(n());)e++;return r.slice(t,e)||p},n=(a=0)=>r.charCodeAt(e+a),s=(a=1)=>r.substr(e,a),p="",c=(r=0,o,s=a.space(),c,l=e,i=0,d)=>{for(;l===e&&i<a.token.length;)c=a.token[i++](s);for(i=Math.max(0|u[s=a.space()],r);i<a.operator.length&&!(s===o||i<r);)(d=a.operator[i++](c,s,i,o))&&(d.indexOf(p)>=0&&t("Bad expression"),c=d,i=Math.max(0|u[s=a.space()],r));return!r&&o&&n()!=o&&t("Unclosed paren"),c};a.space=r=>{for(;(r=n())<=32;)e++;return r},a.token=[e=>(e=o((e=>e>47&&e<58||46===e)))?((69===n()||101===n())&&(e+=o(2)+o((e=>e>=48&&e<=57))),isNaN(e=parseFloat(e))?t("Bad number"):e):p,(e,r)=>34===e?o()+o((r=>r-e))+o():p,r=>40===r?(++e,r=c(0,41),++e,r===p?t():r):p,e=>o((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e))],a.operator=[(e,r,a,t)=>44==r&&l(s(),e,a,t),(e,r,a,t)=>124==r&&n(1)==r&&l(s(2),e,a,t),(e,r,a,t)=>38==r&&n(1)==r&&l(s(2),e,a,t),(e,r,a,t)=>124==r&&l(s(),e,a,t),(e,r,a,t)=>94==r&&l(s(),e,a,t),(e,r,a,t)=>38==r&&l(s(),e,a,t),(e,r,a,t)=>(61==r||33==r)&&61==n(1)&&[o(n(1)==n(2)?3:2),e,c(a,t)],(e,r,a,t)=>(62==r||60==r)&&r!=n(1)&&[o(),e,c(a,t)],(e,r,a,t)=>(60==r||62==r)&&r==n(1)&&[o(r==n(2)?3:2),e,c(a,t)],(e,r,a,t)=>(43==r||45==r)&&e!==p&&n(1)!=r&&l(s(),e,a,t),(e,r,a,t)=>(42==r&&42!=n(1)||47==r||37==r)&&l(s(),e,a,t),(e,r,a,t)=>(43==r||45==r)&&n(1)==r&&[o(2),e===p?c(a-1,t):e],(e,r,a,t)=>(43==r||45==r||33==r)&&e===p&&[o(),c(a-1,t)],(r,a,t,n,s)=>46==a?[o(),r,"string"==typeof(s=c(t,n))?'"'+s+'"':s]:91==a?(e++,r=[".",r,c(0,93)],e++,r):40==a?(e++,s=c(0,41),e++,Array.isArray(s)&&","===s[0]?(s[0]=r,s):s===p?[r]:[r,s]):p];var l=(e,r,t,p,l=[e,r],u=n())=>{do{o(e.length),l.push(c(t,p))}while(a.space()==u&&s(e.length)==e);return l},u=[];u[44]=0,u[124]=1,u[38]=2,u[94]=4,u[61]=u[33]=6,u[60]=u[62]=7,u[43]=u[45]=9,u[42]=u[47]=u[37]=10,u[46]=u[91]=u[40]=13;var i=a,d=e=>Array.isArray(e)&&("string"==typeof e[0]||d(e[0])),f=(e,r={},a,t)=>d(e)?("string"==typeof(a=e[0])&&(t=y[a]),"function"!=typeof(a=t||f(a,r))?a:a.call(...e.map((e=>f(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e,y=f.operator={"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))},h=f,g=e=>(e="string"==typeof e?i(e):e,r=>h(e,r));export{g as default,h as evaluate,i as parse};