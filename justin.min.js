const e=r=>Array.isArray(r)&&("string"==typeof r[0]||e(r[0])),r=(n,o={},s,a)=>e(n)?("string"==typeof(s=n[0])&&(a=t[s]),"function"!=typeof(s=a||r(s,o))?s:s.call(...n.map((e=>r(e,o))))):n&&"string"==typeof n?'"'===n[0]?n.slice(1,-1):"@"===n[0]?n.slice(1):n in o?o[n]:n:n,t={};let n,o;r.operator=(e,r)=>t[e]=2==r.length?(...e)=>e.reduce(r):r;const s=(e,r)=>(o=e,n=0,r=p(),n<o.length?a():d(r)),a=(e="Bad syntax")=>{throw Error(e+" `"+o[n]+"` at "+n)},f=(e=1,r=n)=>{if("number"==typeof e)n+=e;else for(;e(i());)n++;return o.slice(r,n)},i=(e=0)=>o.charCodeAt(n+e),l=(e=1)=>o.substr(n,e),p=(e=0,r,t,o,f=0,i,l)=>{for(;(t=s.space())&&(l=y[t]?.(o,e)||!o&&u(t));)o=l;return r&&(t!=r?a("Unclosed paren"):n++),o};s.space=e=>{for(;(e=i())<=32;)n++;return e};const c=s.token=[],u=(e,r=0,t)=>{for(;r<c.length;)if(t=c[r++](e))return t},y=[];s.operator=(e,r=0,t=0,o,a=e.charCodeAt(0),c=e.length,u=y[a],h=t<=0&&e.toUpperCase()!==e)=>(o=t?t>0?e=>e&&[f(c),d(e)]:t<0?e=>!e&&[f(c),d(p(r-1))]:t:t=>{t=[e,d(t)];do{n+=c,t.push(d(p(r)))}while(s.space()==a&&(c<2||l(c)==e)&&(!h||i(c)<=32));return t},y[a]=(t,n)=>n<r&&(c<2||l(c)==e)&&(!h||i(c)<=32)&&o(t)||u&&u(t,n));const d=e=>Array.isArray(e)?e:(e||a()).valueOf();s.token.push((e=>(e=f((e=>e>47&&e<58||46==e)))&&((69==i()||101==i())&&(e+=f(2)+f((e=>e>=48&&e<=57))),isNaN(e=new Number(e))?a("Bad number"):e)),((e,r,t,n)=>{if(34===e||39===e){for(r=l(),f(),n="";(t=i())-e;)92===t?(f(),n+=h[l()]||l()):n+=l(),f();return f(),r+n+r}}),(e=>f((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e))));const h={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"};s.space=e=>{for(;(e=i())<=32||47===e;)if(e<=32)f();else if(47===e)if(42===i(1))f(2),f((e=>42!==e&&47!==i(1))),f(2);else{if(47!==i(1))break;f(2),f((e=>e>=32))}return e};const g=(e,r=2,t)=>{for(let n=0;n<t.length;n+=r)e(t[n],t[n+1],t[n+2])};g(s.operator,3,[",",1,,"|",6,,"||",4,,"&",8,,"&&",5,,"^",7,,"==",9,,"!=",9,,">",10,,">=",10,,">>",11,,">>>",11,,"<",10,,"<=",10,,"<<",11,,"+",12,,"+",15,-1,"++",15,-1,"++",15,1,"-",12,,"-",15,-1,"--",15,-1,"--",15,1,"!",15,-1,"*",13,,"/",13,,"%",13,,".",18,(e,r)=>e&&[f(),e,"string"==typeof(r=p(18))?'"'+r+'"':r.valueOf()],"[",18,e=>(f(),[".",e,d(p(0,93))]),"]",,,"(",18,(e,r)=>(f(),r=p(0,41),Array.isArray(r)&&","===r[0]?(r[0]=e,r):r?[e,d(r)]:[e]),"(",19,(e,r)=>!e&&(f(),p(0,41)||a()),")",,,";",1,,"===",9,,"!==",9,,"**",14,,"~",15,-1,"?",3,e=>{let r,t;return e||a("Expected expression"),f(),s.space(),r=p(),58!==i()&&a("Expected :"),f(),s.space(),t=p(),["?:",e,r,t]},"}",,,":",,,"in",10,e=>i(2)<=32&&[f(2),'"'+e+'"',p(10)],"[",20,(e,r)=>!e&&(f(),(r=p(0,93))?","==r[0]?(r[0]="[",r):["[",r]:["["]),"{",20,(e,r)=>!e&&(f(),(r=p(0,125))?":"==r[0]?["{",r]:","==r[0]?(r[0]="{",r):["{",r]:["{"]),"null",20,e=>!e&&(f(4),A(null)),"false",20,e=>!e&&(f(5),A(!1)),"true",20,e=>!e&&(f(4),A(!0)),"undefined",20,e=>!e&&(f(9),A(void 0))]);const A=e=>({valueOf:()=>e});g(r.operator,2,["!",e=>!e,"++",e=>++e,"--",e=>--e,".",(e,r)=>e?e[r]:e,"%",(e,r)=>e%r,"/",(e,r)=>e/r,"*",(e,r)=>e*r,"+",(e,r)=>e+r,"-",(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>",(e,r)=>e>>>r,">>",(e,r)=>e>>r,"<<",(e,r)=>e<<r,">=",(e,r)=>e>=r,">",(e,r)=>e>r,"<=",(e,r)=>e<=r,"<",(e,r)=>e<r,"!=",(e,r)=>e!=r,"==",(e,r)=>e==r,"&",(e,r)=>e&r,"^",(e,r)=>e^r,"|",(e,r)=>e|r,"&&",(...e)=>e.every(Boolean),"||",(...e)=>e.some(Boolean),",",(e,r)=>r,"**",(...e)=>e.reduceRight(((e,r)=>Math.pow(r,e))),"~",e=>~e,"?:",(e,r,t)=>e?r:t,"in",(e,r)=>e in r,"[",(...e)=>Array(...e),"{",(...e)=>Object.fromEntries(e),":",(e,r)=>[e,r]]);var b=e=>(e="string"==typeof e?s(e):e,t=>r(e,t));export{b as default,r as evaluate,s as parse};