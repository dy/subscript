var e,r,n,t=e=>Array.isArray(e)&&("string"==typeof e[0]||t(e[0])),l=(e,r={},n,i)=>t(e)?("string"==typeof(n=e[0])&&(i=u[n]),"function"!=typeof(n=i||l(n,r))?n:n.call(...e.map((e=>l(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e,u=l.operator={"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))},i=l,o=t=>(r=t,e=n=0,f()),a=()=>{for(;d()<=32;)e++},s=(r,t,l,u=3)=>{if(e&&n&&n[3]===e)return n;for(;u;)if(null!=(l=r[t=c(u--)]))return n=[t,l,t.length,e]},f=(r,n=-1)=>{a();let t,l,u,i=d(),o=0,p=e;if(i!==r){for(;p===e&&o<g.length;)l=g[o++](i);if(p===e)(t=s(v))&&(e+=t[2],l=[t[0],f(r,t[1])]);else{if(a(),i=d(),i===r)return l;for(o=0;o<x.length;)(u=x[o](l,i))!==l?(l=u,o=0,a(),i=d()):o++}for(a();(i=d())&&i!==r&&(t=s(b))&&t[1]>n;){l=[t[0],l];do{e+=t[2],l.push(f(r,t[1]))}while(c(t[2])===t[0]);a()}return l}},p=e=>(e=y((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192)))&&A.hasOwnProperty(e)?A[e]:e,d=()=>r.charCodeAt(e),c=(n=1)=>r.substr(e,n),h=r=>{throw Error(r+" at "+e)},y=(n=1,t=e)=>{if("number"==typeof n)e+=n;else for(;n(d());)++e>r.length&&h("Unexpected end "+n);return e>t?r.slice(t,e):null},g=o.token=[(r,n)=>40===r?(e++,n=f(41),e++,n):null,(r,n,t)=>{if(r=y(t=e=>e>=48&&e<=57)||"",46===d()&&(e++,r+="."+y(t)),r)return(69===(n=d())||101===n)&&(e++,r+="e",(43===(n=d())||45===n)&&(r+=c(),e++),r+=y(t)),parseFloat(r)},(r,n)=>34===r?(n=c(),e++,n+y((e=>e!==r))+(e++,n)):null,p],A=o.literal={true:!0,false:!1,null:null},x=o.postfix=[(r,n,t)=>(46===n?(e++,a(),r=[".",r,'"'+p()+'"']):91===n?(e++,r=[".",r,f(93)],e++):40===n&&(e++,t=f(41),r=Array.isArray(t)&&","===t[0]?(t[0]=r,t):null==t?[r]:[r,t],e++),r),(n,t)=>43!==t&&45!==t||r.charCodeAt(e+1)!==t?n:[y(2),n]],v=o.unary={"-":17,"!":17,"+":17,"++":17,"--":17},b=o.binary={",":1,"||":6,"&&":7,"|":8,"^":9,"&":10,"==":11,"!=":11,"<":12,">":12,"<=":12,">=":12,"<<":13,">>":13,">>>":13,"+":14,"-":14,"*":15,"/":15,"%":15},m=o,w=e=>(e="string"==typeof e?m(e):e,r=>i(e,r));A.undefined=void 0,g.push(((e,r)=>39===e?(r=c(),index++,r+y((r=>r!==e))+(index++,r)):null)),b["**"]=16,u["**"]=(...e)=>e.reduceRight(((e,r)=>Math.pow(r,e))),v["~"]=17,u["~"]=e=>~e,b[";"]=1,u["?:"]=(e,r,n)=>e?r:n,x.push((e=>{let r,n;return 63!==d()||(y(),a(),r=f(58),58!==d())?e:(y(),a(),n=f(),["?:",e,r,n])})),l.operator.in=(e,r)=>e in r,o.postfix.unshift((e=>"in"===c(2)?(y(2),["in",'"'+e+'"',f()]):e)),u["["]=(...e)=>Array(...e),g.push(((e,r)=>91===d()?(y(),e=null==(r=f(93))?["["]:","===r[0]?(r[0]="[",r):["[",r],y(),e):null)),b[":"]=2,g.unshift((e=>123===d()?(y(),e=B(["{",f(125)]),y(),e):null)),u["{"]=(...e)=>Object.fromEntries(e),u[":"]=(e,r)=>[e,r];var B=(e,r)=>(null==e[1]?r=[]:":"==e[1][0]?r=[e[1]]:","==e[1][0]&&(r=e[1].slice(1)),["{",...r]);export{w as default,l as evaluate,o as parse};