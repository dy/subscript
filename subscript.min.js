var e,r,t,n=()=>r.charCodeAt(e),l=(t=1)=>r.substr(e,t),o=r=>{throw Error(r+" at "+e)},a=(t=1,l=e)=>{if("number"==typeof t)e+=t;else for(;t(n());)++e>r.length&&o("Unexpected end "+t);return e>l?r.slice(l,e):null},u=()=>{for(;n()<=32;)e++},s=(r,n,o,a=3)=>{if(e&&t&&t[3]===e)return t;for(;a;)if(null!=(o=r[n=l(a--)]))return t=[n,o,n.length,e]},i=(r,t=-1)=>{u();let o,a,f=n();if(l(),c.token.find((e=>null!=(a=e()))),null==a)(o=s(c.unary))&&(e+=o[2],a=[o[0],i(r,o[1])]);else do{u()}while(c.postfix.find(((e,r)=>(r=e(a))!==a&&(a=r))));for(u();(f=n())&&f!==r&&(o=s(c.binary))&&o[1]>t;){a=[o[0],a];do{e+=o[2],a.push(i(r,o[1]))}while(l(o[2])===o[0]);u()}return a},f=()=>a((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192)),c=Object.assign((n=>(r=n,e=t=0,i())),{token:[(r=40,t=41,l)=>n()===r?(e++,l=i(t),e++,l):null,(r,t,o)=>{if(r=a(o=e=>e>=48&&e<=57)||"",46===n()&&(e++,r+="."+a(o)),r)return(69===(t=n())||101===t)&&(e++,r+="e",(43===(t=n())||45===t)&&(r+=l(),e++),r+=a(o)),parseFloat(r)},(r=n(),t)=>34===r||39===r?(t=l(),e++,t+a((e=>e!==r))+(e++,t)):null,f],postfix:[e=>"string"==typeof e?"true"===e||"false"!==e&&("null"===e?null:e):e,r=>46===n()?(e++,u(),[".",r,'"'+f()+'"']):r,r=>(91===n()&&(e++,r=[".",r,i(93)],e++),r),(r,t)=>(40===n()&&(e++,t=i(41),r=Array.isArray(t)&&","===t[0]?(t[0]=r,t):null==t?[r]:[r,t],e++),r),(t,l=n()<<8|r.charCodeAt(e+1))=>11051===l||11565===l?[a(2),t]:t],unary:{"-":17,"!":17,"+":17,"++":17,"--":17},binary:{",":1,"||":6,"&&":7,"|":8,"^":9,"&":10,"==":11,"!=":11,"<":12,">":12,"<=":12,">=":12,"<<":13,">>":13,">>>":13,"+":14,"-":14,"*":15,"/":15,"%":15}}),p=c,d=e=>Array.isArray(e)&&("string"==typeof e[0]||d(e[0])),y=Object.assign(((e,r={},t,n)=>d(e)?("string"==typeof(t=e[0])&&(n=y.operator[t]),"function"!=typeof(t=n||y(t,r))?t:t.call(...e.map((e=>y(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e),{operator:{"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))}}),g=y,h=e=>(e="string"==typeof e?p(e):e,r=>g(e,r));export{h as default,g as evaluate,p as parse};