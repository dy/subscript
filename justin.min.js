var f,l,D=r=>(f=0,l=r,r=_(),l[f]?u():r||""),u=(r="Bad syntax",o=l.slice(0,f).split(`
`),m=o.pop())=>{let e=l.slice(f-108,f).split(`
`).pop(),p=l.slice(f,f+108).split(`
`).shift();throw EvalError(`${r} at ${o.length}:${m.length} \`${f>=108?"\u2026":""}${e}\u2503${p}\``)},S=(r,o=f,m)=>{for(;m=r(l.charCodeAt(f));)f+=m;return l.slice(o,f)},h=()=>l[f++],_=(r=0,o)=>{let m,e,p,n;for(;(m=b())&&(p=((n=N[m])&&n(e,r))??(!e&&S(D.id)));)e=p;return o&&(m==o?f++:u()),e},b=r=>{for(;(r=l.charCodeAt(f))<=32;)f++;return r},_r=D.id=r=>r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||r==36||r==95||r>=192&&r!=215&&r!=247,N=[],C=(r,o=32,m,e=r.charCodeAt(0),p=r.length,n=N[e],A=r.toUpperCase()!==r)=>N[e]=(L,$,B,a=f)=>(B?r==B:(p<2||l.substr(f,p)==r)&&(B=r))&&$<o&&!(A&&D.id(l.charCodeAt(f+p)))&&(f+=p,m(L)||(f=a,!n&&u()))||n?.(L,$,B),E=(r,o,m=!1)=>C(r,o,(e,p)=>e&&(p=_(o-(m?.5:0)))&&[r,e,p]),y=(r,o,m)=>C(r,o,e=>m?e&&[r,e]:!e&&(e=_(o-.5))&&[r,e]),Q=(r,o,m)=>{C(r,o,(e,p)=>(p=_(o),e?.[0]!==r&&(e=[r,e||null]),p?.[0]===r?e.push(...p.slice(1)):e.push(p||null),e))},I=(r,o)=>C(r[0],o,m=>!m&&[r,_(0,r.charCodeAt(1))]),X=(r,o)=>C(r[0],o,m=>m&&[r,m,_(0,r.charCodeAt(1))||null]),w=D;var i=r=>Array.isArray(r)?r[0]?K[r[0]].call(...r):()=>r[1]:i.id(r),Sr=i.id=r=>o=>o?.[r],K={},t=(r,o,m=K[r])=>K[r]=(...e)=>o(...e)||m?.(...e),P=(r,o,m,e,p)=>r[0]==="()"&&r.length==2?P(r[1],o,m):typeof r=="string"?n=>o(n,r,n):r[0]==="."?(e=i(r[1]),p=r[2],n=>o(e(n),p,n)):r[0]==="[]"&&r.length===3?(e=i(r[1]),p=i(r[2]),n=>o(e(n),p(n),n)):m?(r=i(r),n=>o([r(n)],0,n)):()=>u("Bad left value"),s=i;var c=(r,o)=>[,(r=+S(m=>m===46||m>=48&&m<=57||(m===69||m===101?2:0)))!=r?u():r];N[46]=r=>!r&&c();for(let r=48;r<=57;r++)N[r]=o=>o?u():c();var er={n:`
`,r:"\r",t:"	",b:"\b",f:"\f",v:"\v"},V=r=>(o,m,e="")=>(o&&u("Unexpected string"),h(),S(p=>p-r&&(p===92?(e+=er[l[f+1]]||l[f+1],2):(e+=l[f],1))),h()||u("Bad string"),[,e]);N[34]=V(34);N[39]=V(39);X("()",170);t("()",(r,o,m)=>o!==void 0&&(m=o?o[0]===","?(o=o.slice(1).map(e=>e?i(e):err()),e=>o.map(p=>p(e))):(o=i(o),e=>[o(e)]):()=>[],P(r,(e,p,n)=>e[p](...m(n)),!0)));X("[]",170);t("[]",(r,o)=>o?(r=i(r),o=i(o),m=>r(m)[o(m)]):err());E(".",170);t(".",(r,o)=>(r=i(r),o=o[0]?o:o[1],m=>r(m)[o]));I("()",170);t("()",(r,o)=>o===void 0&&(!r&&u("Empty ()"),i(r)));var W=(...r)=>(r=r.map(i),o=>r.map(m=>m(o)).pop());Q(",",10),t(",",W);Q(";",5,!0),t(";",W);E("=",20,!0);t("=",(r,o)=>(o=i(o),P(r,(m,e,p)=>m[e]=o(p))));E("*",120),t("*",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)*o(m)));E("/",120),t("/",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)/o(m)));E("%",120),t("%",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)%o(m)));E("*=",20,!0);t("*=",(r,o)=>(o=i(o),P(r,(m,e,p)=>m[e]*=o(p))));E("/=",20,!0);t("/=",(r,o)=>(o=i(o),P(r,(m,e,p)=>m[e]/=o(p))));E("%=",20,!0);t("%=",(r,o)=>(o=i(o),P(r,(m,e,p)=>m[e]%=o(p))));E("+",110),t("+",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)+o(m)));E("-",110),t("-",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)-o(m)));y("+",140),t("+",(r,o)=>!o&&(r=i(r),m=>+r(m)));y("-",140),t("-",(r,o)=>!o&&(r=i(r),m=>-r(m)));E("+=",20,!0);t("+=",(r,o)=>(o=i(o),P(r,(m,e,p)=>m[e]+=o(p))));E("-=",20,!0);t("-=",(r,o)=>(o=i(o),P(r,(m,e,p)=>m[e]-=o(p))));C("++",150,r=>r?["++",r,null]:["++",_(149)]);t("++",(r,o)=>P(r,o===null?(m,e)=>m[e]++:(m,e)=>++m[e]));C("--",150,r=>r?["--",r,null]:["--",_(149)]);t("--",(r,o)=>P(r,o===null?(m,e)=>m[e]--:(m,e)=>--m[e]));y("~",140),t("~",(r,o)=>!o&&(r=i(r),m=>~r(m)));E("|",50),t("|",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)|o(m)));E("&",70),t("&",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)&o(m)));E("^",60),t("^",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)^o(m)));y("!",140),t("!",(r,o)=>!o&&(r=i(r),m=>!r(m)));E("||",30);t("||",(r,o)=>(r=i(r),o=i(o),m=>r(m)||o(m)));E("&&",40);t("&&",(r,o)=>(r=i(r),o=i(o),m=>r(m)&&o(m)));E("==",80),t("==",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)==o(m)));E("!=",80),t("!=",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)!=o(m)));E(">",90),t(">",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)>o(m)));E("<",90),t("<",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)<o(m)));E(">=",90),t(">=",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)>=o(m)));E("<=",90),t("<=",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)<=o(m)));E(">>",100),t(">>",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)>>o(m)));E("<<",100),t("<<",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)<<o(m)));E(">>=",20,!0);t(">>=",(r,o)=>(o=i(o),prop(r,(m,e,p)=>m[e]>>=o(p))));E("<<=",20,!0);t("<<=",(r,o)=>(o=i(o),prop(r,(m,e,p)=>m[e]<<=o(p))));function g(r){if(!r)return"";if(Array.isArray(r)){let[o,...m]=r;return o?o=="[]"||o=="{}"||o=="()"?(m.length>1?g(m.shift()):"")+o[0]+g(m[0])+o[1]:m.length===1?o+g(m[0]):m.length===2?g(m[0])+(o==="."?o:" "+o+" ")+g(m[1]):m.filter(Boolean).map(e=>g(e)).join(o+`
`):JSON.stringify(m[0])}return r}var x=r=>s(w(r));C("/*",200,(r,o)=>(S(m=>m!==42&&l.charCodeAt(f+1)!==47),h(),h(),r||_(o)||[]));C("//",200,(r,o)=>(S(m=>m>=32),r||_(o)||[]));E("**",130,!0),t("**",(r,o)=>o&&(r=i(r),o=i(o),m=>r(m)**o(m)));C("?",20,(r,o,m)=>r&&(o=_(19))&&S(e=>e===58)&&(m=_(19),["?",r,o,m]));t("?",(r,o,m)=>(r=i(r),o=i(o),m=i(m),e=>r(e)?o(e):m(e)));C("true",200,r=>r?err():[,!0]);C("false",200,r=>r?err():[,!1]);I("[]",200);t("[]",(r,o)=>o===void 0&&(r=r?r[0]===","?r.slice(1):[r]:[],r=r.map(m=>m[0]==="..."?(m=i(m[1]),e=>m(e)):(m=i(m),e=>[m(e)])),m=>r.flatMap(e=>e(m))));I("{}",200);t("{}",(r,o)=>o===void 0&&(r=r?r[0]!==","?[r]:r.slice(1):[],r=r.map(m=>i(typeof m=="string"?[":",m,m]:m)),m=>Object.fromEntries(r.flatMap(e=>e(m)))));E(":",19,!0);t(":",(r,o)=>(o=i(o),Array.isArray(r)?(r=i(r),m=>[[r(m),o(m)]]):m=>[[r,o(m)]]));E("=>",20,!0);t("=>",(r,o)=>(r=r[0]==="()"?r[1]:r,r=r?r[0]===","?r=r.slice(1):r=[r]:[],o=i(o[0]==="{}"?o[1]:o),(m=null)=>(m=Object.create(m),(...e)=>(r.map((p,n)=>m[p]=e[n]),o(m)))));E("");C("?.",170,r=>r&&["?.",r]);t("?.",r=>(r=i(r),o=>r(o)||(()=>{})));C("?.",170,(r,o)=>r&&(o=_(170),!o?.map)&&["?.",r,o]);t("?.",(r,o)=>o&&(r=i(r),m=>r(m)?.[o]));t("()",(r,o,m,e,p,n)=>o!==void 0&&r[0]==="?."&&(r[2]||Array.isArray(r[1]))&&(e=o?o[0]===","?(o=o.slice(1).map(i),A=>o.map(L=>L(A))):(o=i(o),A=>[o(A)]):()=>[],!r[2]&&(n=!0,r=r[1]),r[0]==="[]"&&r.length===3?p=i(r[2]):p=()=>r[2],m=i(r[1]),n?A=>m(A)?.[p(A)]?.(...e(A)):A=>m(A)?.[p(A)](...e(A))));y("...",140);t("...",r=>(r=i(r),o=>Object.entries(r(o))));E("in",90),t("in",(r,o)=>o&&(r=s(r),o=s(o),m=>r(m)in o(m)));E("===",80),E("!==",9);t("===",(r,o)=>(r=s(r),o=s(o),m=>r(m)===o(m)));t("!==",(r,o)=>(r=s(r),o=s(o),m=>r(m)!==o(m)));E("??",30);t("??",(r,o)=>o&&(r=s(r),o=s(o),m=>r(m)??o(m)));E("??=",20,!0);t("??=",(r,o)=>(o=s(o),P(r,(m,e,p)=>m[e]??=o(p))));E("||=",20,!0);t("||=",(r,o)=>(o=s(o),P(r,(m,e,p)=>m[e]||=o(p))));E("&&=",20,!0);t("&&=",(r,o)=>(o=s(o),P(r,(m,e,p)=>m[e]&&=o(p))));E(">>>",80);t(">>>",(r,o)=>(r=s(r),o=s(o),m=>r(m)>>>o(m)));E(">>>=",20,!0);t(">>>=",(r,o)=>(o=s(o),P(r,(m,e,p)=>m[e]>>>=o(p))));C("undefined",20,r=>r?u():[,void 0]);C("NaN",20,r=>r?u():[,NaN]);C("null",20,r=>r?u():[,null]);var Gm=x;export{X as access,E as binary,i as compile,Gm as default,I as group,Q as nary,t as operator,D as parse,g as stringify,C as token,y as unary};
