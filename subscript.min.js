let t,e,r=r=>(t=0,e=r,r=a(),e[t]?s():r||""),s=(r="Bad syntax",s=e.slice(0,t).split("\n"),o=s.pop())=>{let a=e.slice(t-108,t).split("\n").pop(),n=e.slice(t,t+108).split("\n").shift();throw EvalError(`${r} at ${s.length}:${o.length} \`${t>=108?"…":""}${a}▶${n}\``,"font-weight: bold")},o=(r=1,s=t,o)=>{if("number"==typeof r)t+=r;else for(;o=r(e.charCodeAt(t));)t+=o;return e.slice(s,t)},a=(e=0,o,a,n,p,c)=>{for(;(a=r.space())&&(p=((c=l[a])&&c(n,e))??(!n&&r.id()));)n=p;return o&&(a==o?t++:s()),n},n=t=>t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||36==t||95==t||t>=192&&215!=t&&247!=t;r.id=()=>o(n);let p=r.space=r=>{for(;(r=e.charCodeAt(t))<=32;)t++;return r},l=[],c=(r,s=32,o,a=r.charCodeAt(0),p=r.length,c=l[a],i=r.toUpperCase()!==r)=>l[a]=(a,l,d=t)=>l<s&&(p<2||e.substr(t,p)==r)&&(!i||!n(e.charCodeAt(t+p)))&&(t+=p,o(a,l))||(t=d,c?.(a,l)),i=(t,e,r=!1)=>c(t,e,((s,o)=>s&&(o=a(e-(r?.5:0)))&&[t,s,o])),d=(t,e,r)=>c(t,e,(s=>r?s&&[t,s]:!s&&(s=a(e-.5))&&[t,s])),f=(t,e)=>{c(t,e,((r,s)=>(s=a(e),(!r||r[0]!==t)&&(r=[t,r]),r.push(s),r)))},h=(t,e)=>c(t[0],e,(e=>!e&&[t,a(0,t.charCodeAt(1))])),u=(t,e)=>c(t[0],e,(e=>e&&[t[0],e,a(0,t.charCodeAt(1))]));const A=t=>t?s():[,(t=+o((t=>46===t||t>=48&&t<=57||(69===t||101===t?2:0))))!=t?s():t];l[46]=t=>!t&&A();for(let t=48;t<=57;t++)l[t]=A;const C={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},g=r=>(a,n,p="")=>{for(a&&s("Unexpected string"),o();(n=e.charCodeAt(t))-r;)92===n?(o(),n=o(),p+=C[n]||n):p+=o();return o()||s("Bad string"),[,p]};l[34]=g(34),l[39]=g(39);const m=t=>Array.isArray(t)?t[0]?y[t[0]](...t.slice(1)):()=>t[1]:m.id(t);m.id=t=>e=>e?.[t];const y={},$=(t,e,r=y[t])=>y[t]=(...t)=>e(...t)||r&&r(...t),b=(t,e,r,o,a)=>"()"===t[0]?b(t[1],e,r):"string"==typeof t?r=>e(r,t,r):"."===t[0]?(o=m(t[1]),a=t[2],t=>e(o(t),a,t)):"["===t[0]?(o=m(t[1]),a=m(t[2]),t=>e(o(t),a(t),t)):r?(t=m(t),r=>e([t(r)],0,r)):()=>s("Bad left value");u("()",17),$("(",((t,e,r)=>(r=e?","===e[0]?(e=e.slice(1).map((t=>t?m(t):err())),t=>e.map((e=>e(t)))):(e=m(e),t=>[e(t)]):()=>[],b(t,((t,e,s)=>t[e](...r(s))),!0)))),u("[]",17),$("[",((t,e)=>e?(t=m(t),e=m(e),r=>t(r)[e(r)]):err())),i(".",17),$(".",((t,e)=>(t=m(t),e=e[0]?e:e[1],r=>t(r)[e]))),h("()",17),$("()",(t=>(!t&&s("Empty ()"),m(t))));const v=(...t)=>(t=t.map(m),e=>t.map((t=>t(e))).pop());f(",",1),$(",",v),f(";",1),$(";",v),i("*",12),$("*",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)*e(r)))),i("/",12),$("/",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)/e(r)))),i("%",12),$("%",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)%e(r)))),i("*=",2,!0),$("*=",((t,e)=>(e=m(e),b(t,((t,r,s)=>t[r]*=e(s)))))),i("/=",2,!0),$("/=",((t,e)=>(e=m(e),b(t,((t,r,s)=>t[r]/=e(s)))))),i("%=",2,!0),$("%=",((t,e)=>(e=m(e),b(t,((t,r,s)=>t[r]%=e(s)))))),d("+",14),$("+",((t,e)=>!e&&(t=m(t),e=>+t(e)))),d("-",14),$("-",((t,e)=>!e&&(t=m(t),e=>-t(e)))),i("+",11),$("+",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)+e(r)))),i("-",11),$("-",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)-e(r)))),i("+=",2,!0),$("+=",((t,e)=>(e=m(e),b(t,((t,r,s)=>t[r]+=e(s)))))),i("-=",2,!0),$("-=",((t,e)=>(e=m(e),b(t,((t,r,s)=>t[r]-=e(s)))))),c("++",15,(t=>t?["++-",t]:["++",a(14)])),$("++",(t=>b(t,((t,e,r)=>++t[e])))),$("++-",(t=>b(t,((t,e,r)=>t[e]++)))),c("--",15,(t=>t?["--+",t]:["--",a(14)])),$("--",(t=>b(t,((t,e,r)=>--t[e])))),$("--+",(t=>b(t,((t,e,r)=>t[e]--)))),d("~",14),$("~",((t,e)=>!e&&(t=m(t),e=>~t(e)))),i("|",5),$("|",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)|e(r)))),i("&",7),$("&",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)&e(r)))),i("^",6),$("^",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)^e(r)))),i(">>",10),$(">>",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)>>e(r)))),i("<<",10),$("<<",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)<<e(r)))),i("==",8),$("==",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)==e(r)))),i("!=",8),$("!=",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)!=e(r)))),i(">",8),$(">",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)>e(r)))),i("<",8),$("<",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)<e(r)))),i(">=",8),$(">=",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)>=e(r)))),i("<=",8),$("<=",((t,e)=>e&&(t=m(t),e=m(e),r=>t(r)<=e(r)))),d("!",14),$("!",((t,e)=>!e&&(t=m(t),e=>!t(e)))),i("||",3),$("||",((t,e)=>(t=m(t),e=m(e),r=>t(r)||e(r)))),i("&&",4),$("&&",((t,e)=>(t=m(t),e=m(e),r=>t(r)&&e(r)))),i("=",2,!0),$("=",((t,e)=>(e=m(e),b(t,((t,r,s)=>t[r]=e(s))))));var x=t=>m(r(t));export{u as access,i as binary,m as compile,e as cur,x as default,s as err,a as expr,h as group,t as idx,n as isId,l as lookup,f as nary,$ as operator,y as operators,r as parse,b as prop,o as skip,p as space,c as token,d as unary};