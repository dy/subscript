let r,t,e=e=>(r=0,t=e,e=n(),t[r]?s():e||""),s=(e="Bad syntax",s=t.slice(0,r).split("\n"),a=s.pop())=>{let n=t.slice(r-108,r).split("\n").pop(),o=t.slice(r,r+108).split("\n").shift();throw EvalError(`${e} at ${s.length}:${a.length} \`${r>=108?"…":""}${n}▶${o}\``,"font-weight: bold")},a=(e=1,s=r,a)=>{if("number"==typeof e)r+=e;else for(;a=e(t.charCodeAt(r));)r+=a;return t.slice(s,r)},n=(t=0,a,n,o,p,i)=>{for(;(n=e.space())&&(p=((i=l[n])&&i(o,t))??(!o&&e.id()));)o=p;return a&&(n==a?r++:s()),o},o=r=>r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||36==r||95==r||r>=192&&215!=r&&247!=r,p=e.id=()=>a(o),i=e.space=e=>{for(;(e=t.charCodeAt(r))<=32;)r++;return e},l=[],c=(e,s=32,a,n=e.charCodeAt(0),p=e.length,i=l[n],c=e.toUpperCase()!==e)=>l[n]=(n,l,d=r)=>l<s&&(p<2||t.substr(r,p)==e)&&(!c||!o(t.charCodeAt(r+p)))&&(r+=p,a(n,l))||(r=d,i?.(n,l)),d=(r,t,e=!1)=>c(r,t,((s,a)=>s&&(a=n(t-(e?.5:0)))&&[r,s,a])),f=(r,t,e)=>c(r,t,(s=>e?s&&[r,s]:!s&&(s=n(t-.5))&&[r,s])),h=(r,t)=>{c(r,t,((e,s)=>(s=n(t),(!e||e[0]!==r)&&(e=[r,e]),e.push(s),e)))},b=(r,t)=>c(r[0],t,(t=>!t&&[r,n(0,r.charCodeAt(1))])),u=(r,t)=>c(r[0],t,(t=>t&&[r[0],t,n(0,r.charCodeAt(1))]));const A=r=>r?s():[,(r=+a((r=>46===r||r>=48&&r<=57||(69===r||101===r?2:0))))!=r?s():r];l[46]=r=>!r&&A();for(let r=48;r<=57;r++)l[r]=A;const C={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},g=e=>(n,o,p="")=>{for(n&&s("Unexpected string"),a();(o=t.charCodeAt(r))-e;)92===o?(a(),o=a(),p+=C[o]||o):p+=a();return a()||s("Bad string"),[,p]};l[34]=g(34),l[39]=g(39);const m=r=>Array.isArray(r)?r[0]?y[r[0]](...r.slice(1)):()=>r[1]:t=>t?.[r],y={},$=(r,t,e=y[r])=>y[r]=(...r)=>t(...r)||e&&e(...r),v=(r,t,e)=>"()"===r[0]?v(r[1],t,e):"string"==typeof r?t.bind(0,(r=>r),(()=>r)):"."===r[0]?t.bind(0,m(r[1]),(r=r[2],()=>r)):"["===r[0]?t.bind(0,m(r[1]),m(r[2])):e?(r=m(r),t.bind(0,(t=>[r(t)]),(()=>0))):()=>s("Bad left value");u("()",17),$("(",((r,t,e)=>(e=t?","===t[0]?(t=t.slice(1).map((r=>r?m(r):err())),r=>t.map((t=>t(r)))):(t=m(t),r=>[t(r)]):()=>[],v(r,((r,t,s)=>r(s)[t(s)](...e(s))),!0)))),u("[]",17),$("[",((r,t)=>t?(r=m(r),t=m(t),e=>r(e)[t(e)]):err())),d(".",17),$(".",((r,t)=>(r=m(r),t=t[0]?t:t[1],e=>r(e)[t]))),b("()",17),$("()",(r=>(!r&&s("Empty ()"),m(r))));const x=(...r)=>(r=r.map(m),t=>r.map((r=>r(t))).pop());h(",",1),$(",",x),h(";",1),$(";",x),d("*",12),$("*",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)*t(e)))),d("/",12),$("/",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)/t(e)))),d("%",12),$("%",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)%t(e)))),d("*=",2,!0),$("*=",((r,t)=>(t=m(t),v(r,((r,e,s)=>r(s)[e(s)]*=t(s)))))),d("/=",2,!0),$("/=",((r,t)=>(t=m(t),v(r,((r,e,s)=>r(s)[e(s)]/=t(s)))))),d("%=",2,!0),$("%=",((r,t)=>(t=m(t),v(r,((r,e,s)=>r(s)[e(s)]%=t(s)))))),f("+",14),$("+",((r,t)=>!t&&(r=m(r),t=>+r(t)))),f("-",14),$("-",((r,t)=>!t&&(r=m(r),t=>-r(t)))),d("+",11),$("+",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)+t(e)))),d("-",11),$("-",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)-t(e)))),d("+=",2,!0),$("+=",((r,t)=>(t=m(t),v(r,((r,e,s)=>r(s)[e(s)]+=t(s)))))),d("-=",2,!0),$("-=",((r,t)=>(t=m(t),v(r,((r,e,s)=>r(s)[e(s)]-=t(s)))))),c("++",15,(r=>r?["-",["++",r],[,1]]:["++",n(14)])),$("++",(r=>v(r,((r,t,e)=>++r(e)[t(e)])))),c("--",15,(r=>r?["+",["--",r],[,1]]:["--",n(14)])),$("--",(r=>v(r,((r,t,e)=>--r(e)[t(e)])))),f("~",14),$("~",((r,t)=>!t&&(r=m(r),t=>~r(t)))),d("|",5),$("|",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)|t(e)))),d("&",7),$("&",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)&t(e)))),d("^",6),$("^",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)^t(e)))),d(">>",10),$(">>",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)>>t(e)))),d("<<",10),$("<<",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)<<t(e)))),d("==",8),$("==",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)==t(e)))),d("!=",8),$("!=",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)!=t(e)))),d(">",8),$(">",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)>t(e)))),d("<",8),$("<",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)<t(e)))),d(">=",8),$(">=",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)>=t(e)))),d("<=",8),$("<=",((r,t)=>t&&(r=m(r),t=m(t),e=>r(e)<=t(e)))),f("!",14),$("!",((r,t)=>!t&&(r=m(r),t=>!r(t)))),d("||",3),$("||",((r,t)=>(r=m(r),t=m(t),e=>r(e)||t(e)))),d("&&",4),$("&&",((r,t)=>(r=m(r),t=m(t),e=>r(e)&&t(e)))),d("=",2,!0),$("=",((r,t)=>(t=m(t),v(r,((r,e,s)=>r(s)[e(s)]=t(s))))));var B=r=>m(e(r));export{u as access,d as binary,m as compile,t as cur,B as default,s as err,n as expr,b as group,p as id,r as idx,o as isId,l as lookup,h as nary,$ as operator,y as operators,e as parse,v as prop,a as skip,i as space,c as token,f as unary};