let t,r,e=e=>(t=0,r=e,e=a(),r[t]?o():e||""),o=(e="Bad syntax",o=r.slice(0,t).split("\n"),s=o.pop())=>{let p=r.slice(t-108,t).split("\n").pop(),a=r.slice(t,t+108).split("\n").shift();throw EvalError(`${e} at ${o.length}:${s.length} \`${t>=108?"…":""}${p}┃${a}\``,"font-weight: bold")},s=(e,o=t,s)=>{for(;s=e(r.charCodeAt(t));)t+=s;return r.slice(o,t)},p=(e=1,o=t)=>(t+=e,r.slice(o,t)),a=(r=0,p)=>{let a,i,c,d;for(;(a=l())&&(c=((d=n[a])&&d(i,r))??(!i&&s(e.id)));)i=c;return p&&(a==p?t++:o()),i},l=e=>{for(;(e=r.charCodeAt(t))<=32;)t++;return e};e.id=t=>t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||36==t||95==t||t>=192&&215!=t&&247!=t;let n=[],i=(s,p=32,a,l=s.charCodeAt(0),i=s.length,c=n[l],d=s.toUpperCase()!==s)=>n[l]=(l,n,h,f=t)=>(h?s==h:(i<2||r.substr(t,i)==s)&&(h=s))&&n<p&&!(d&&e.id(r.charCodeAt(t+i)))&&(t+=i,a(l)||(t=f,!c&&o()))||c?.(l,n,h),c=(t,r,e=!1)=>i(t,r,((o,s)=>o&&(s=a(r-(e?.5:0)))&&[t,o,s])),d=(t,r,e)=>i(t,r,(o=>e?o&&[t,o]:!o&&(o=a(r-.5))&&[t,o])),h=(t,r,e)=>{i(t,r,((e,o)=>(o=a(r),e?.[0]!==t&&(e=[t,e]),o?.[0]===t?e.push(...o.slice(1)):e.push(o),e)))},f=(t,r)=>i(t[0],r,(r=>!r&&[t,a(0,t.charCodeAt(1))])),u=(t,r)=>i(t[0],r,(r=>r&&[t[0],r,a(0,t.charCodeAt(1))]));const A=(t,r)=>[,(t=+s((t=>46===t||t>=48&&t<=57||(69===t||101===t?2:0))))!=t?o():t];n[46]=t=>!t&&A();for(let t=48;t<=57;t++)n[t]=t=>t?o():A();const C={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},g=e=>(s,a,l="")=>{for(s&&o("Unexpected string"),p();(a=r.charCodeAt(t))-e;)92===a?(p(),a=p(),l+=C[a]||a):l+=p();return p()||o("Bad string"),[,l]};n[34]=g(34),n[39]=g(39);const $=t=>Array.isArray(t)?t[0]?m[t[0]](...t.slice(1)):()=>t[1]:$.id(t);$.id=t=>r=>r?.[t];const m={},v=(t,r,e=m[t])=>m[t]=(...t)=>r(...t)||e&&e(...t),y=(t,r,e,s,p)=>"()"===t[0]?y(t[1],r,e):"string"==typeof t?e=>r(e,t,e):"."===t[0]?(s=$(t[1]),p=t[2],t=>r(s(t),p,t)):"["===t[0]?(s=$(t[1]),p=$(t[2]),t=>r(s(t),p(t),t)):e?(t=$(t),e=>r([t(e)],0,e)):()=>o("Bad left value");u("()",170),v("(",((t,r,e)=>(e=r?","===r[0]?(r=r.slice(1).map((t=>t?$(t):err())),t=>r.map((r=>r(t)))):(r=$(r),t=>[r(t)]):()=>[],y(t,((t,r,o)=>t[r](...e(o))),!0)))),u("[]",170),v("[",((t,r)=>r?(t=$(t),r=$(r),e=>t(e)[r(e)]):err())),c(".",170),v(".",((t,r)=>(t=$(t),r=r[0]?r:r[1],e=>t(e)[r]))),f("()",170),v("()",(t=>(!t&&o("Empty ()"),$(t))));const b=(...t)=>(t=t.map($),r=>t.map((t=>t(r))).pop());h(",",10),v(",",b),h(";",5),v(";",b),c("=",20,!0),v("=",((t,r)=>(r=$(r),y(t,((t,e,o)=>t[e]=r(o)))))),c("*",120),v("*",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)*r(e)))),c("/",120),v("/",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)/r(e)))),c("%",120),v("%",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)%r(e)))),c("*=",20,!0),v("*=",((t,r)=>(r=$(r),y(t,((t,e,o)=>t[e]*=r(o)))))),c("/=",20,!0),v("/=",((t,r)=>(r=$(r),y(t,((t,e,o)=>t[e]/=r(o)))))),c("%=",20,!0),v("%=",((t,r)=>(r=$(r),y(t,((t,e,o)=>t[e]%=r(o)))))),c("+",110),v("+",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)+r(e)))),c("-",110),v("-",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)-r(e)))),d("+",140),v("+",((t,r)=>!r&&(t=$(t),r=>+t(r)))),d("-",140),v("-",((t,r)=>!r&&(t=$(t),r=>-t(r)))),c("+=",20,!0),v("+=",((t,r)=>(r=$(r),y(t,((t,e,o)=>t[e]+=r(o)))))),c("-=",20,!0),v("-=",((t,r)=>(r=$(r),y(t,((t,e,o)=>t[e]-=r(o)))))),i("++",150,(t=>t?["++-",t]:["++",a(149)])),v("++",(t=>y(t,((t,r,e)=>++t[r])))),v("++-",(t=>y(t,((t,r,e)=>t[r]++)))),i("--",150,(t=>t?["--+",t]:["--",a(149)])),v("--",(t=>y(t,((t,r,e)=>--t[r])))),v("--+",(t=>y(t,((t,r,e)=>t[r]--)))),d("~",140),v("~",((t,r)=>!r&&(t=$(t),r=>~t(r)))),c("|",50),v("|",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)|r(e)))),c("&",70),v("&",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)&r(e)))),c("^",60),v("^",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)^r(e)))),c("==",80),v("==",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)==r(e)))),c("!=",80),v("!=",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)!=r(e)))),c(">",90),v(">",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)>r(e)))),c("<",90),v("<",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)<r(e)))),c(">=",90),v(">=",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)>=r(e)))),c("<=",90),v("<=",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)<=r(e)))),c(">>",100),v(">>",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)>>r(e)))),c("<<",100),v("<<",((t,r)=>r&&(t=$(t),r=$(r),e=>t(e)<<r(e)))),c(">>=",20,!0),v(">>=",((t,r)=>(r=$(r),prop(t,((t,e,o)=>t[e]>>=r(o)))))),c("<<=",20,!0),v("<<=",((t,r)=>(r=$(r),prop(t,((t,e,o)=>t[e]<<=r(o)))))),d("!",140),v("!",((t,r)=>!r&&(t=$(t),r=>!t(r)))),c("||",30),v("||",((t,r)=>(t=$(t),r=$(r),e=>t(e)||r(e)))),c("&&",40),v("&&",((t,r)=>(t=$(t),r=$(r),e=>t(e)&&r(e))));var x=t=>$(e(t));export{u as access,c as binary,$ as compile,x as default,f as group,h as nary,v as operator,e as parse,i as token,d as unary};