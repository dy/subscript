let r,e,t=t=>(r=0,e=t,t=i(),e[r]?a():t||""),a=(t="Bad syntax",a=e.slice(0,r).split("\n"),l=a.pop())=>{let s=e.slice(r-108,r).split("\n").pop(),i=e.slice(r,r+108).split("\n").shift();throw EvalError(`${t} at ${a.length}:${l.length} \`${r>=108?"…":""}${s}┃${i}\``,"font-weight: bold")},l=(t,a=r,l)=>{for(;l=t(e.charCodeAt(r));)r+=l;return e.slice(a,r)},s=(t=1,a=r)=>(r+=t,e.slice(a,r)),i=(e=0,s)=>{let i,o,c,d;for(;(i=p())&&(c=((d=n[i])&&d(o,e))??(!o&&l(t.id)));)o=c;return s&&(i==s?r++:a()),o},p=t=>{for(;(t=e.charCodeAt(r))<=32;)r++;return t};t.id=r=>r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||36==r||95==r||r>=192&&215!=r&&247!=r;let n=[],o=(l,s=32,i,p=l.charCodeAt(0),o=l.length,c=n[p],d=l.toUpperCase()!==l)=>n[p]=(p,n,f,h=r)=>(f?l==f:(o<2||e.substr(r,o)==l)&&(f=l))&&n<s&&!(d&&t.id(e.charCodeAt(r+o)))&&(r+=o,i(p)||(r=h,!c&&a()))||c?.(p,n,f),c=(r,e,t=!1)=>o(r,e,((a,l)=>a&&(l=i(e-(t?.5:0)))&&[r,a,l])),d=(r,e,t)=>o(r,e,(a=>t?a&&[r,a]:!a&&(a=i(e-.5))&&[r,a])),f=(r,e,t)=>{o(r,e,((t,a)=>(a=i(e),t?.[0]!==r&&(t=[r,t]),a?.[0]===r?t.push(...a.slice(1)):t.push(a),t)))},h=(r,e)=>o(r[0],e,(e=>!e&&[r,i(0,r.charCodeAt(1))])),u=(r,e)=>o(r[0],e,(e=>e&&[r[0],e,i(0,r.charCodeAt(1))]));const A=r=>Array.isArray(r)?r[0]?m[r[0]](...r.slice(1)):()=>r[1]:A.id(r);A.id=r=>e=>e?.[r];const m={},y=(r,e,t=m[r])=>m[r]=(...r)=>e(...r)||t&&t(...r),C=(r,e,t,l,s)=>"()"===r[0]?C(r[1],e,t):"string"==typeof r?t=>e(t,r,t):"."===r[0]?(l=A(r[1]),s=r[2],r=>e(l(r),s,r)):"["===r[0]?(l=A(r[1]),s=A(r[2]),r=>e(l(r),s(r),r)):t?(r=A(r),t=>e([r(t)],0,t)):()=>a("Bad left value"),g=(r,e)=>[,(r=+l((r=>46===r||r>=48&&r<=57||(69===r||101===r?2:0))))!=r?a():r];n[46]=r=>!r&&g();for(let r=48;r<=57;r++)n[r]=r=>r?a():g();const b={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},v=t=>(l,i,p="")=>{for(l&&a("Unexpected string"),s();(i=e.charCodeAt(r))-t;)92===i?(s(),i=s(),p+=b[i]||i):p+=s();return s()||a("Bad string"),[,p]};n[34]=v(34),n[39]=v(39),u("()",170),y("(",((r,e,t)=>(t=e?","===e[0]?(e=e.slice(1).map((r=>r?A(r):err())),r=>e.map((e=>e(r)))):(e=A(e),r=>[e(r)]):()=>[],C(r,((r,e,a)=>r[e](...t(a))),!0)))),u("[]",170),y("[",((r,e)=>e?(r=A(r),e=A(e),t=>r(t)[e(t)]):err())),c(".",170),y(".",((r,e)=>(r=A(r),e=e[0]?e:e[1],t=>r(t)[e]))),h("()",170),y("()",(r=>(!r&&a("Empty ()"),A(r))));const $=(...r)=>(r=r.map(A),e=>r.map((r=>r(e))).pop());f(",",10),y(",",$),f(";",5),y(";",$),c("=",20,!0),y("=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]=e(a)))))),c("*",120),y("*",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)*e(t)))),c("/",120),y("/",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)/e(t)))),c("%",120),y("%",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)%e(t)))),c("*=",20,!0),y("*=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]*=e(a)))))),c("/=",20,!0),y("/=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]/=e(a)))))),c("%=",20,!0),y("%=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]%=e(a)))))),c("+",110),y("+",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)+e(t)))),c("-",110),y("-",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)-e(t)))),d("+",140),y("+",((r,e)=>!e&&(r=A(r),e=>+r(e)))),d("-",140),y("-",((r,e)=>!e&&(r=A(r),e=>-r(e)))),c("+=",20,!0),y("+=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]+=e(a)))))),c("-=",20,!0),y("-=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]-=e(a)))))),o("++",150,(r=>r?["++-",r]:["++",i(149)])),y("++",(r=>C(r,((r,e,t)=>++r[e])))),y("++-",(r=>C(r,((r,e,t)=>r[e]++)))),o("--",150,(r=>r?["--+",r]:["--",i(149)])),y("--",(r=>C(r,((r,e,t)=>--r[e])))),y("--+",(r=>C(r,((r,e,t)=>r[e]--)))),d("~",140),y("~",((r,e)=>!e&&(r=A(r),e=>~r(e)))),c("|",50),y("|",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)|e(t)))),c("&",70),y("&",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)&e(t)))),c("^",60),y("^",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)^e(t)))),c("==",80),y("==",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)==e(t)))),c("!=",80),y("!=",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)!=e(t)))),c(">",90),y(">",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)>e(t)))),c("<",90),y("<",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)<e(t)))),c(">=",90),y(">=",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)>=e(t)))),c("<=",90),y("<=",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)<=e(t)))),c(">>",100),y(">>",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)>>e(t)))),c("<<",100),y("<<",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)<<e(t)))),c(">>=",20,!0),y(">>=",((r,e)=>(e=A(e),prop(r,((r,t,a)=>r[t]>>=e(a)))))),c("<<=",20,!0),y("<<=",((r,e)=>(e=A(e),prop(r,((r,t,a)=>r[t]<<=e(a)))))),d("!",140),y("!",((r,e)=>!e&&(r=A(r),e=>!r(e)))),c("||",30),y("||",((r,e)=>(r=A(r),e=A(e),t=>r(t)||e(t)))),c("&&",40),y("&&",((r,e)=>(r=A(r),e=A(e),t=>r(t)&&e(t))));var E=r=>A(t(r));o("/*",200,((t,a)=>(l((t=>42!==t&&47!==e.charCodeAt(r+1))),s(2),t||i(a)||[]))),o("//",200,((r,e)=>(l((r=>r>=32)),r||i(e)||[]))),c("**",130,!0),y("**",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)**e(t)))),o("?",20,((r,e,t)=>r&&(e=i(19))&&l((r=>58===r))&&["?",r,e,i(19)])),y("?",((r,e,t)=>(r=A(r),e=A(e),t=A(t),a=>r(a)?e(a):t(a)))),o("true",200,(r=>r?err():[,!0])),o("false",200,(r=>r?err():[,!1])),h("[]",200),y("[]",((r,e)=>(r=(r=r?","===r[0]?r.slice(1):[r]:[]).map((r=>"..."===r[0]?(r=A(r[1]),e=>r(e)):(r=A(r),e=>[r(e)]))),e=>r.flatMap((r=>r(e)))))),h("{}",200),y("{}",((r,e)=>(r=(r=r?","!==r[0]?[r]:r.slice(1):[]).map((r=>A("string"==typeof r?[":",r,r]:r))),e=>Object.fromEntries(r.flatMap((r=>r(e))))))),c(":",19,!0),y(":",((r,e)=>(e=A(e),Array.isArray(r)?(r=A(r),t=>[[r(t),e(t)]]):t=>[[r,e(t)]]))),c("=>",20,!0),y("=>",((r,e)=>(r=(r="()"===r[0]?r[1]:r)?r=","===r[0]?r.slice(1):[r]:[],e=A("{}"===e[0]?e[1]:e),(t=null)=>(t=Object.create(t),(...a)=>(r.map(((r,e)=>t[r]=a[e])),e(t)))))),c(""),o("?.",170,(r=>r&&["?.",r])),y("?.",(r=>(r=A(r),e=>r(e)||(()=>{})))),o("?.",170,((r,e)=>r&&!(e=i(170))?.map&&["?.",r,e])),y("?.",((r,e)=>e&&(r=A(r),t=>r(t)?.[e]))),y("(",((r,e,t,a,l,s)=>"?."===r[0]&&(r[2]||Array.isArray(r[1]))&&(a=e?","===e[0]?(e=e.slice(1).map(A),r=>e.map((e=>e(r)))):(e=A(e),r=>[e(r)]):()=>[],!r[2]&&(r=r[1]),l="["===r[0]?A(r[2]):()=>r[2],t=A(r[1]),r=>t(r)?.[l(r)]?.(...a(r))))),d("...",140),y("...",(r=>(r=A(r),e=>Object.entries(r(e))))),c("in",90),y("in",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)in e(t)))),c("===",80),c("!==",9),y("===",((r,e)=>(r=A(r),e=A(e),t=>r(t)===e(t)))),y("!==",((r,e)=>(r=A(r),e=A(e),t=>r(t)!==e(t)))),c("??",30),y("??",((r,e)=>e&&(r=A(r),e=A(e),t=>r(t)??e(t)))),c("??=",20,!0),y("??=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]??=e(a)))))),c("||=",20,!0),y("||=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]||=e(a)))))),c("&&=",20,!0),y("&&=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]&&=e(a)))))),c(">>>",80),y(">>>",((r,e)=>(r=A(r),e=A(e),t=>r(t)>>>e(t)))),c(">>>=",20,!0),y(">>>=",((r,e)=>(e=A(e),C(r,((r,t,a)=>r[t]>>>=e(a)))))),o("undefined",20,(r=>r?a():[,void 0])),o("NaN",20,(r=>r?a():[,NaN])),o("null",20,(r=>r?a():[,null]));export{u as access,c as binary,A as compile,E as default,h as group,f as nary,y as operator,t as parse,o as token,d as unary};