let t,e,r=r=>(t=0,e=r,r=s(),e[t]?n():r||""),n=(r="Bad syntax",n=e.slice(0,t).split("\n"),l=n.pop())=>{let s=e.slice(t-108,t).split("\n").pop(),a=e.slice(t,t+108).split("\n").shift();throw EvalError(`${r} at ${n.length}:${l.length} \`${s+a}\``,"font-weight: bold")},l=(r=1,n=t,l)=>{if("number"==typeof r)t+=r;else for(;l=r(e.charCodeAt(t));)t+=l;return e.slice(n,t)},s=(e=0,l,s,a,o,h)=>{for(;(s=r.space())&&(o=((h=i[s])&&h(a,e))??(!a&&r.id()));)a=o;return l&&(s==l?t++:n()),a},a=t=>t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||36==t||95==t||t>=192&&215!=t&&247!=t,o=r.space=r=>{for(;(r=e.charCodeAt(t))<=32;)t++;return r},h=r.id=t=>l(a),i=[],p=(r,n=32,l,s=r.charCodeAt(0),o=r.length,h=i[s],p=r.toUpperCase()!==r)=>i[s]=(s,i,c=t)=>i<n&&(o<2||e.substr(t,o)==r)&&(!p||!a(e.charCodeAt(t+o)))&&(t+=o,l(s,i))||(t=c,h?.(s,i)),c=(t,e,r=0)=>p(t,e,((n,l)=>n&&(l=s(e-r/2))&&[t,n,l])),d=(t,e,r)=>p(t,e,(n=>r?n&&[t,n]:!n&&(n=s(e-.5))&&[t,n])),g=(t,e,r)=>{p(t,e,((n,l)=>(n||r)&&((l=s(e))||r)&&((!n||n[0]!==t)&&(n=[t,n]),(l||r)&&n.push(l),n)))};const f=t=>t?n():[,(t=+l((t=>46===t||t>=48&&t<=57||(69===t||101===t?2:0))))!=t?n():t];i[46]=t=>!t&&f();for(let t=48;t<=57;t++)i[t]=f;const u={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},b=r=>(s,a,o="")=>{for(s&&n("Unexpected string"),l();(a=e.charCodeAt(t))-r;)92===a?(l(),a=l(),o+=u[a]||a):o+=l();return l()||n("Bad string"),[,o]};i[34]=b(34),i[39]=b(39);const A=t=>Array.isArray(t)?t[0]?m[t[0]](...t.slice(1)):()=>t[1]:e=>e?.[t],m={},y=(t,e,r=m[t])=>m[t]=(...t)=>e(...t)||r&&r(...t),C=(t,e,r)=>"()"===t[0]?C(t[1],e,r):"string"==typeof t?e.bind(0,(t=>t),(()=>t)):"."===t[0]?e.bind(0,A(t[1]),(t=t[2],()=>t)):"["===t[0]?e.bind(0,A(t[1]),A(t[2])):r?(t=A(t),e.bind(0,(e=>[t(e)]),(()=>0))):()=>n("Bad left value");p("(",17,((t,e)=>t&&((e=s(0,41))?["(",t,e]:["(",t,""]))),y("(",((t,e,r)=>(r=""==e?()=>[]:","===e[0]?(e=e.slice(1).map(A),t=>e.map((e=>e(t)))):(e=A(e),t=>[e(t)]),C(t,((t,e,n)=>t(n)[e(n)](...r(n))),!0)))),p("[",17,(t=>t&&["[",t,s(0,93)||n()])),y("[",((t,e)=>e&&(t=A(t),e=A(e),r=>t(r)[e(r)]))),p(".",17,((t,e)=>t&&(e=s(17))&&[".",t,e])),y(".",((t,e)=>(t=A(t),e=e[0]?e:e[1],r=>t(r)[e])));const v=(t,e,r)=>r.length?r.length>1?(c(t,Math.abs(e),e<0),y(t,((t,e)=>e&&(t=A(t),e=A(e),t.length||e.length?n=>r(t(n),e(n)):(t=r(t(),e()),()=>t))))):(d(t,e),y(t,((t,e)=>!e&&((t=A(t)).length?e=>r(t(e)):(t=r(t()),()=>t))))):(g(t,Math.abs(e),e<0),y(t,((...t)=>(t=t.map(A),e=>r(...t.map((t=>t(e))))))));var $=t=>A(r(t));p("(",17,(t=>!t&&["()",s(0,41)||n("Empty group")])),y("()",(t=>A(t))),v(",",1,((...t)=>t[t.length-1])),v(";",-1,((...t)=>t[t.length-1])),v("*",12,((t,e)=>t*e)),v("/",12,((t,e)=>t/e)),v("%",12,((t,e)=>t%e)),c("*=",2,!0),y("*=",((t,e)=>(e=A(e),C(t,((t,r,n)=>t(n)[r(n)]*=e(n)))))),c("/=",2,!0),y("/=",((t,e)=>(e=A(e),C(t,((t,r,n)=>t(n)[r(n)]/=e(n)))))),c("%=",2,!0),y("%=",((t,e)=>(e=A(e),C(t,((t,r,n)=>t(n)[r(n)]%=e(n)))))),v("+",14,(t=>+t)),v("-",14,(t=>-t)),v("+",11,((t,e)=>t+e)),v("-",11,((t,e)=>t-e)),c("+=",2,!0),y("+=",((t,e)=>(e=A(e),C(t,((t,r,n)=>t(n)[r(n)]+=e(n)))))),c("-=",2,!0),y("-=",((t,e)=>(e=A(e),C(t,((t,r,n)=>t(n)[r(n)]-=e(n)))))),p("++",15,(t=>t?["-",["++",t],[,1]]:["++",s(14)])),y("++",(t=>C(t,((t,e,r)=>++t(r)[e(r)])))),p("--",15,(t=>t?["+",["--",t],[,1]]:["--",s(14)])),y("--",(t=>C(t,((t,e,r)=>--t(r)[e(r)])))),v("~",14,(t=>~t)),v("|",5,((t,e)=>t|e)),v("&",7,((t,e)=>t&e)),v("^",6,((t,e)=>t^e)),v(">>",10,((t,e)=>t>>e)),v("<<",10,((t,e)=>t<<e)),v("==",8,((t,e)=>t==e)),v("!=",8,((t,e)=>t!=e)),v(">",8,((t,e)=>t>e)),v(">=",8,((t,e)=>t>=e)),v("<",8,((t,e)=>t<e)),v("<=",8,((t,e)=>t<=e)),v("!",14,(t=>!t)),v("||",3,((...t)=>{let e,r=0;for(;!e&&r<t.length;)e=t[r++];return e})),v("&&",4,((...t)=>{let e=0,r=!0;for(;r&&e<t.length;)r=t[e++];return r})),c("=",2,!0),y("=",((t,e)=>(e=A(e),C(t,((t,r,n)=>t(n)[r(n)]=e(n))))));export{C as access,c as binary,A as compile,e as cur,$ as default,n as err,s as expr,h as id,t as idx,a as isId,i as lookup,g as nary,y as operator,m as operators,r as parse,v as set,l as skip,o as space,p as token,d as unary};