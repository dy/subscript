import r from"./jsep.min.js";export{default as parse}from"./jsep.min.js";var e=function r(e,o){try{var s,c=e;switch(c.type){case"ArrayExpression":return Promise.resolve(t(c.elements,o));case"BinaryExpression":return Promise.resolve(Promise.all([r(c.left,o),r(c.right,o)])).then(function(r){return u[c.operator](r[0],r[1])});case"CallExpression":var a,l,f,p=function(){if("function"==typeof l){var r=l,e=r.apply,n=a;return Promise.resolve(t(c.arguments,o)).then(function(t){return Promise.resolve(e.call(r,n,t))})}},m="MemberExpression"===c.callee.type?Promise.resolve(n(c.callee,o)).then(function(r){a=(f=r)[0],l=f[1]}):Promise.resolve(r(c.callee,o)).then(function(r){l=r});return Promise.resolve(m&&m.then?m.then(p):p());case"ConditionalExpression":return Promise.resolve(r(c.test,o)).then(function(e){return Promise.resolve(r(e?c.consequent:c.alternate,o))});case"Identifier":return Promise.resolve(o[c.name]);case"Literal":return Promise.resolve(c.value);case"LogicalExpression":var v=function(e){return s?e:Promise.resolve(Promise.all([r(c.left,o),r(c.right,o)])).then(function(r){return u[c.operator](r[0],r[1])})},h="||"===c.operator?(s=1,Promise.resolve(r(c.left,o)).then(function(e){return e||Promise.resolve(r(c.right,o))})):function(){if("&&"===c.operator)return s=1,Promise.resolve(r(c.left,o)).then(function(e){return e?Promise.resolve(r(c.right,o)):e})}();return Promise.resolve(h&&h.then?h.then(v):v(h));case"MemberExpression":return Promise.resolve(n(c,o)).then(function(r){return r[1]});case"ThisExpression":return Promise.resolve(o);case"UnaryExpression":var P=i[c.operator];return Promise.resolve(r(c.argument,o)).then(function(r){return P.call(i,r)});default:return Promise.resolve(void 0)}}catch(r){return Promise.reject(r)}},n=function(r,n){try{return Promise.resolve(e(r.object,n)).then(function(t){function o(){if(/^__proto__|prototype|constructor$/.test(u))throw Error('Access to member "'+u+'" disallowed.');return[t,t[u]]}var u,i=function(){if(r.computed)return Promise.resolve(e(r.property,n)).then(function(r){u=r});u=r.property.name}();return i&&i.then?i.then(o):o()})}catch(r){return Promise.reject(r)}},t=function(r,n){try{return Promise.resolve(Promise.all(r.map(function(r){return e(r,n)})))}catch(r){return Promise.reject(r)}},o={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},u={"||":function(r,e){return r||e},"&&":function(r,e){return r&&e},"|":function(r,e){return r|e},"^":function(r,e){return r^e},"&":function(r,e){return r&e},"==":function(r,e){return r==e},"!=":function(r,e){return r!=e},"===":function(r,e){return r===e},"!==":function(r,e){return r!==e},"<":function(r,e){return r<e},">":function(r,e){return r>e},"<=":function(r,e){return r<=e},">=":function(r,e){return r>=e},"<<":function(r,e){return r<<e},">>":function(r,e){return r>>e},">>>":function(r,e){return r>>>e},"+":function(r,e){return r+e},"-":function(r,e){return r-e},"*":function(r,e){return r*e},"/":function(r,e){return r/e},"%":function(r,e){return r%e}},i={"-":function(r){return-r},"+":function(r){return+r},"~":function(r){return~r},"!":function(r){return!r}};function s(r,e){return r.map(function(r){return a(r,e)})}function c(r,e){var n,t=a(r.object,e);if(n=r.computed?a(r.property,e):r.property.name,/^__proto__|prototype|constructor$/.test(n))throw Error('Access to member "'+n+'" disallowed.');return[t,t[n]]}function a(r,e){var n=r;switch(n.type){case"ArrayExpression":return s(n.elements,e);case"BinaryExpression":return u[n.operator](a(n.left,e),a(n.right,e));case"CallExpression":var t,o,l;if("MemberExpression"===n.callee.type?(t=(l=c(n.callee,e))[0],o=l[1]):o=a(n.callee,e),"function"!=typeof o)return;return o.apply(t,s(n.arguments,e));case"ConditionalExpression":return a(n.test,e)?a(n.consequent,e):a(n.alternate,e);case"Identifier":return e[n.name];case"Literal":return n.value;case"LogicalExpression":return"||"===n.operator?a(n.left,e)||a(n.right,e):"&&"===n.operator?a(n.left,e)&&a(n.right,e):u[n.operator](a(n.left,e),a(n.right,e));case"MemberExpression":return c(n,e)[1];case"ThisExpression":return e;case"UnaryExpression":return i[n.operator](a(n.argument,e));default:return}}function l(e){return a.bind(null,r(e))}function f(n){return e.bind(null,r(n))}function p(e,n){r.addUnaryOp(e),i[e]=n}function m(e,n,t){t?(r.addBinaryOp(e,n),u[e]=t):(r.addBinaryOp(e,o[e]||1),u[e]=n)}export{m as addBinaryOp,p as addUnaryOp,l as compile,f as compileAsync,a as eval,e as evalAsync};
