let t,e,l=l=>(t=0,e=l,l=s(),e[t]?r():l||""),r=(l="Bad syntax",r=e[t],n=e.slice(0,t).split("\n"),a=n.pop())=>{throw SyntaxError(`${l} ${r?`\`${r}\` `:""}at ${n.length}:${a.length}`,n.length)},n=(l="Bad syntax",r=e[t],n=e.slice(0,t).split("\n"),a=n.pop())=>{let s=e.slice(t-10,t).split("\n").pop(),h=e.slice(t+1,t+10).split("\n").shift(),p=n.length+":"+a.length;throw EvalError(`${l} at ${p} \`${s+r+h}\`\n${" ".repeat(18+l.length+p.length+s.length+1)}^`)},a=(l=1,r=t,n)=>{if("number"==typeof l)t+=l;else for(;n=l(e.charCodeAt(t));)t+=n;return e.slice(r,t)},s=(e=0,n,a,s,h,p)=>{for(;(a=l.space())&&(h=((p=g[a])&&p(s,e))??(!s&&l.id()));)s=h;return n&&(a==n?t++:r()),s},h=t=>t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||36==t||95==t||t>=192&&215!=t&&247!=t,p=l.space=l=>{for(;(l=e.charCodeAt(t))<=32;)t++;return l},o=l.id=t=>a(h),g=[],i=(l,r=32,n,a=l.charCodeAt(0),s=l.length,p=g[a],o=l.toUpperCase()!==l)=>g[a]=(a,g,i=t)=>g<r&&(s<2||e.substr(t,s)==l)&&(!o||!h(e.charCodeAt(t+s)))&&(t+=s,n(a,g))||(t=i,p?.(a,g)),c=(t,e,l=0)=>i(t,e,((r,n)=>r&&(n=s(e-l/2))&&[t,r,n])),d=(t,e,l)=>i(t,e,(r=>l?r&&[t,r]:!r&&(r=s(e-.5))&&[t,r])),f=(t,e,l)=>{i(t,e,((r,n)=>(r||l)&&((n=s(e))||l)&&((!r||r[0]!==t)&&(r=[t,r]),(n||l)&&r.push(n),r)))};const u=t=>Array.isArray(t)?$[t[0]](...t.slice(1)):e=>e?.[t],$={},y=(t,e,l=$[t])=>$[t]=(...t)=>e(...t)||l&&l(...t),A=t=>(t=l(t),e=>(t.call?t:t=u(t))(e)),m=(t,e,l)=>l.length?l.length>1?(c(t,Math.abs(e),e<0),y(t,((t,e)=>e&&(t=u(t),e=u(e),t.length||e.length?r=>l(t(r),e(r)):(t=l(t(),e()),()=>t))))):(d(t,e),y(t,((t,e)=>!e&&((t=u(t)).length?e=>l(t(e)):(t=l(t()),()=>t))))):(f(t,Math.abs(e),e<0),y(t,((...t)=>(t=t.map(u),e=>l(...t.map((t=>t(e)))))))),C=t=>t?r():["",(t=+a((t=>46===t||t>=48&&t<=57||(69===t||101===t?2:0))))!=t?r():t],b=(t,e,l,r)=>(i(t,e,(l=>l?["++"===t?"-":"+",[t,l],["",1]]:[t,s(e-1)])),y(t,r=(t,e)=>"("===t[0]?r(t[1]):"."===t[0]?(e=t[2],t=u(t[1]),r=>l(t(r),e)):"["===t[0]?([,t,e]=t,t=u(t),e=u(e),r=>l(t(r),e(r))):e=>l(e,t)));y("",(t=>()=>t)),g[34]=t=>t?r():["",(a()+a((t=>t-34?1:0))+(a()||r("Bad string"))).slice(1,-1)],g[46]=t=>!t&&C();for(let t=0;t<9;t++)g[48+t]=C;m(",",1,((...t)=>t[t.length-1])),m("||",4,((...t)=>{let e,l=0;for(;!e&&l<t.length;)e=t[l++];return e})),m("&&",5,((...t)=>{let e=0,l=!0;for(;l&&e<t.length;)l=t[e++];return l})),m("+",12,((t,e)=>t+e)),m("-",12,((t,e)=>t-e)),m("*",13,((t,e)=>t*e)),m("/",13,((t,e)=>t/e)),m("%",13,((t,e)=>t%e)),m("|",6,((t,e)=>t|e)),m("&",8,((t,e)=>t&e)),m("^",7,((t,e)=>t^e)),m("==",9,((t,e)=>t==e)),m("!=",9,((t,e)=>t!=e)),m(">",10,((t,e)=>t>e)),m(">=",10,((t,e)=>t>=e)),m("<",10,((t,e)=>t<e)),m("<=",10,((t,e)=>t<=e)),m(">>",11,((t,e)=>t>>e)),m(">>>",11,((t,e)=>t>>>e)),m("<<",11,((t,e)=>t<<e)),m("+",15,(t=>+t)),m("-",15,(t=>-t)),m("!",15,(t=>!t)),b("++",15,((t,e)=>++t[e])),b("--",15,((t,e)=>--t[e])),i("[",18,(t=>t&&["[",t,s(0,93)||r()])),y("[",((t,e)=>e&&(t=u(t),e=u(e),l=>t(l)[e(l)]))),i(".",18,((t,e)=>t&&(e=s(18))&&[".",t,e])),y(".",((t,e)=>(t=u(t),e=e[0]?e:e[1],l=>t(l)[e]))),i("(",18,(t=>!t&&["(",s(0,41)||r()])),i("(",18,((t,e)=>t&&((e=s(0,41))?["(",t,e]:["(",t,""]))),y("(",((t,e,l,r)=>null==e?u(t):(r=""==e?()=>[]:","===e[0]?(e=e.slice(1).map(u),t=>e.map((e=>e(t)))):(e=u(e),t=>[e(t)]),"."===t[0]?(l=t[2],t=u(t[1]),e=>t(e)[l](...r(e))):"["===t[0]?(l=u(t[2]),t=u(t[1]),e=>t(e)[l(e)](...r(e))):(t=u(t),e=>t(e)(...r(e))))));export{c as binary,u as compile,e as cur,A as default,r as err,s as expr,o as id,t as idx,h as isId,n as longErr,g as lookup,f as nary,y as operator,$ as operators,l as parse,m as set,a as skip,p as space,i as token,d as unary};