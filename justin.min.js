let r,t,e=e=>(r=0,t=e,e=a(),t[r]?n():e||""),n=(e="Bad syntax",n=t.slice(0,r).split("\n"),l=n.pop())=>{const i=t.slice(r-108,r).split("\n").pop(),a=t.slice(r,r+108).split("\n").shift();throw EvalError(`${e} at ${n.length}:${l.length} \`${r>=108?"…":""}${i}┃${a}\``,"font-weight: bold")},l=(e,n=r,l)=>{for(;l=e(t.charCodeAt(r));)r+=l;return t.slice(n,r)},i=(e=1,n=r)=>(r+=e,t.slice(n,r)),a=(t=0,i)=>{let a,p,c,d;for(;(a=o())&&(c=((d=s[a])&&d(p,t))??(!p&&l(e.id)));)p=c;return i&&(a==i?r++:n()),p},o=e=>{for(;(e=t.charCodeAt(r))<=32;)r++;return e};e.id=r=>r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||36==r||95==r||r>=192&&215!=r&&247!=r;let s=[],p=(l,i=32,a,o=l.charCodeAt(0),p=l.length,c=s[o],d=l.toUpperCase()!==l)=>s[o]=(o,s,f,h=r)=>(f?l==f:(p<2||t.substr(r,p)==l)&&(f=l))&&s<i&&!(d&&e.id(t.charCodeAt(r+p)))&&(r+=p,a(o)||(r=h,!c&&n()))||c?.(o,s,f),c=(r,t,e=!1)=>p(r,t,((n,l)=>n&&(l=a(t-(e?.5:0)))&&[r,n,l])),d=(r,t,e)=>p(r,t,(n=>e?n&&[r,n]:!n&&(n=a(t-.5))&&[r,n])),f=(r,t,e)=>{p(r,t,((e,n)=>(n=a(t),e?.[0]!==r&&(e=[r,e||null]),n?.[0]===r?e.push(...n.slice(1)):e.push(n||null),e)))},h=(r,t)=>p(r[0],t,(t=>!t&&[r,a(0,r.charCodeAt(1))])),u=(r,t)=>p(r[0],t,(t=>t&&[r,t,a(0,r.charCodeAt(1))||null]));const A=r=>Array.isArray(r)?r[0]?g[r[0]].call(...r):()=>r[1]:A.id(r);A.id=r=>t=>t?.[r];const g={},m=(r,t,e=g[r])=>g[r]=(...r)=>t(...r)||e?.(...r),y=(r,t,e,l,i)=>"()"===r[0]&&2==r.length?y(r[1],t,e):"string"==typeof r?e=>t(e,r,e):"."===r[0]?(l=A(r[1]),i=r[2],r=>t(l(r),i,r)):"[]"===r[0]&&3===r.length?(l=A(r[1]),i=A(r[2]),r=>t(l(r),i(r),r)):e?(r=A(r),e=>t([r(e)],0,e)):()=>n("Bad left value"),v=(r,t)=>[,(r=+l((r=>46===r||r>=48&&r<=57||(69===r||101===r?2:0))))!=r?n():r];s[46]=r=>!r&&v();for(let r=48;r<=57;r++)s[r]=r=>r?n():v();const C={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},b=e=>(l,a,o="")=>{for(l&&n("Unexpected string"),i();(a=t.charCodeAt(r))-e;)92===a?(i(),a=i(),o+=C[a]||a):o+=i();return i()||n("Bad string"),[,o]};s[34]=b(34),s[39]=b(39),u("()",170),m("()",((r,t,e)=>void 0!==t&&(e=t?","===t[0]?(t=t.slice(1).map((r=>r?A(r):err())),r=>t.map((t=>t(r)))):(t=A(t),r=>[t(r)]):()=>[],y(r,((r,t,n)=>r[t](...e(n))),!0)))),u("[]",170),m("[]",((r,t)=>t?(r=A(r),t=A(t),e=>r(e)[t(e)]):err())),c(".",170),m(".",((r,t)=>(r=A(r),t=t[0]?t:t[1],e=>r(e)[t]))),h("()",170),m("()",((r,t)=>void 0===t&&(!r&&n("Empty ()"),A(r))));const $=(...r)=>(r=r.map(A),t=>r.map((r=>r(t))).pop());function N(r){if(!r)return"";if(Array.isArray(r)){const[t,...e]=r;return t?"[]"==t||"{}"==t||"()"==t?(e.length>1?N(e.shift()):"")+t[0]+N(e[0])+t[1]:1===e.length?t+N(e[0]):2===e.length?N(e[0])+("."===t?t:" "+t+" ")+N(e[1]):e.filter(Boolean).map((r=>N(r))).join(t+"\n"):JSON.stringify(e[0])}return r}f(",",10),m(",",$),f(";",5),m(";",$),c("=",20,!0),m("=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]=t(n)))))),c("*",120),m("*",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)*t(e)))),c("/",120),m("/",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)/t(e)))),c("%",120),m("%",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)%t(e)))),c("*=",20,!0),m("*=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]*=t(n)))))),c("/=",20,!0),m("/=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]/=t(n)))))),c("%=",20,!0),m("%=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]%=t(n)))))),c("+",110),m("+",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)+t(e)))),c("-",110),m("-",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)-t(e)))),d("+",140),m("+",((r,t)=>!t&&(r=A(r),t=>+r(t)))),d("-",140),m("-",((r,t)=>!t&&(r=A(r),t=>-r(t)))),c("+=",20,!0),m("+=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]+=t(n)))))),c("-=",20,!0),m("-=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]-=t(n)))))),p("++",150,(r=>r?["++-",r]:["++",a(149)])),m("++",(r=>y(r,((r,t)=>++r[t])))),m("++-",(r=>y(r,((r,t)=>r[t]++)))),p("--",150,(r=>r?["--+",r]:["--",a(149)])),m("--",(r=>y(r,((r,t)=>--r[t])))),m("--+",(r=>y(r,((r,t)=>r[t]--)))),d("~",140),m("~",((r,t)=>!t&&(r=A(r),t=>~r(t)))),c("|",50),m("|",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)|t(e)))),c("&",70),m("&",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)&t(e)))),c("^",60),m("^",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)^t(e)))),c("==",80),m("==",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)==t(e)))),c("!=",80),m("!=",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)!=t(e)))),c(">",90),m(">",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)>t(e)))),c("<",90),m("<",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)<t(e)))),c(">=",90),m(">=",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)>=t(e)))),c("<=",90),m("<=",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)<=t(e)))),c(">>",100),m(">>",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)>>t(e)))),c("<<",100),m("<<",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)<<t(e)))),c(">>=",20,!0),m(">>=",((r,t)=>(t=A(t),prop(r,((r,e,n)=>r[e]>>=t(n)))))),c("<<=",20,!0),m("<<=",((r,t)=>(t=A(t),prop(r,((r,e,n)=>r[e]<<=t(n)))))),d("!",140),m("!",((r,t)=>!t&&(r=A(r),t=>!r(t)))),c("||",30),m("||",((r,t)=>(r=A(r),t=A(t),e=>r(e)||t(e)))),c("&&",40),m("&&",((r,t)=>(r=A(r),t=A(t),e=>r(e)&&t(e))));var j=r=>A(e(r));p("/*",200,((e,n)=>(l((e=>42!==e&&47!==t.charCodeAt(r+1))),i(2),e||a(n)||[]))),p("//",200,((r,t)=>(l((r=>r>=32)),r||a(t)||[]))),c("**",130,!0),m("**",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)**t(e)))),p("?",20,((r,t,e)=>r&&(t=a(19))&&l((r=>58===r))&&["?",r,t,a(19)])),m("?",((r,t,e)=>(r=A(r),t=A(t),e=A(e),n=>r(n)?t(n):e(n)))),p("true",200,(r=>r?err():[,!0])),p("false",200,(r=>r?err():[,!1])),h("[]",200),m("[]",((r,t)=>void 0===t&&(r=(r=r?","===r[0]?r.slice(1):[r]:[]).map((r=>"..."===r[0]?(r=A(r[1]),t=>r(t)):(r=A(r),t=>[r(t)]))),t=>r.flatMap((r=>r(t)))))),h("{}",200),m("{}",((r,t)=>void 0===t&&(r=(r=r?","!==r[0]?[r]:r.slice(1):[]).map((r=>A("string"==typeof r?[":",r,r]:r))),t=>Object.fromEntries(r.flatMap((r=>r(t))))))),c(":",19,!0),m(":",((r,t)=>(t=A(t),Array.isArray(r)?(r=A(r),e=>[[r(e),t(e)]]):e=>[[r,t(e)]]))),c("=>",20,!0),m("=>",((r,t)=>(r=(r="()"===r[0]?r[1]:r)?r=","===r[0]?r.slice(1):[r]:[],t=A("{}"===t[0]?t[1]:t),(e=null)=>(e=Object.create(e),(...n)=>(r.map(((r,t)=>e[r]=n[t])),t(e)))))),c(""),p("?.",170,(r=>r&&["?.",r])),m("?.",(r=>(r=A(r),t=>r(t)||(()=>{})))),p("?.",170,((r,t)=>r&&!(t=a(170))?.map&&["?.",r,t])),m("?.",((r,t)=>t&&(r=A(r),e=>r(e)?.[t]))),m("()",((r,t,e,n,l,i)=>void 0!==t&&"?."===r[0]&&(r[2]||Array.isArray(r[1]))&&(n=t?","===t[0]?(t=t.slice(1).map(A),r=>t.map((t=>t(r)))):(t=A(t),r=>[t(r)]):()=>[],!r[2]&&(r=r[1]),l="[]"===r[0]&&3===r.length?A(r[2]):()=>r[2],e=A(r[1]),r=>e(r)?.[l(r)]?.(...n(r))))),d("...",140),m("...",(r=>(r=A(r),t=>Object.entries(r(t))))),c("in",90),m("in",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)in t(e)))),c("===",80),c("!==",9),m("===",((r,t)=>(r=A(r),t=A(t),e=>r(e)===t(e)))),m("!==",((r,t)=>(r=A(r),t=A(t),e=>r(e)!==t(e)))),c("??",30),m("??",((r,t)=>t&&(r=A(r),t=A(t),e=>r(e)??t(e)))),c("??=",20,!0),m("??=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]??=t(n)))))),c("||=",20,!0),m("||=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]||=t(n)))))),c("&&=",20,!0),m("&&=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]&&=t(n)))))),c(">>>",80),m(">>>",((r,t)=>(r=A(r),t=A(t),e=>r(e)>>>t(e)))),c(">>>=",20,!0),m(">>>=",((r,t)=>(t=A(t),y(r,((r,e,n)=>r[e]>>>=t(n)))))),p("undefined",20,(r=>r?n():[,void 0])),p("NaN",20,(r=>r?n():[,NaN])),p("null",20,(r=>r?n():[,null]));export{u as access,c as binary,A as compile,j as default,h as group,f as nary,m as operator,e as parse,N as stringify,p as token,d as unary};