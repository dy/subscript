var e,r,t,l=(l,n)=>(r=l,e=t=0,n=i(),e<r.length?o():n),n=()=>r.charCodeAt(e),a=(t=1)=>r.substr(e,t),o=(r=a())=>{throw Error("Bad syntax "+r+" at "+e)},u=(t=1,l=e)=>{if("number"==typeof t)e+=t;else for(;t(n());)++e>r.length&&o(t);return e>l?r.slice(l,e):null},s=()=>{for(;n()<=32;)e++},f=(r,l,n,o=3)=>{if(e&&t&&t[3]===e)return t;for(;o;)if(null!=(n=r[l=a(o--)]))return t=[l,n,l.length,e]},i=(r,t=-1)=>{s();let l,o,u,y=n(),p=0,h=e;if(y!==r){for(;h===e&&p<c.length;)o=c[p++](y,r);if(s(),y=n(),y===r)return o;for(p=0;p<d.length;)(u=d[p](o,y))!==o?(o=u,p=0,s(),y=n()):p++;for(s();(y=n())!==r&&(l=f(g))&&l[1]>t;){o=[l[0],o];do{e+=l[2],o.push(i(r,l[1]))}while(a(l[2])===l[0]);s()}return o}},y=e=>(e=u((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192)))&&p.hasOwnProperty(e)?p[e]:e,c=l.token=[e=>{if(e=u((e=>e>=48&&e<=57||46===e)))return(69===n()||101===n())&&(e+=u(2)+u((e=>e>=48&&e<=57))),isNaN(e=parseFloat(e))?o():e},(r,t)=>40===r?(e++,t=i(41),e++,t):null,(r,t)=>34===r?(t=a(),e++,t+u((e=>e-r))+(e++,t)):null,(r,t,l)=>(l=f(h))&&(e+=l[2],[l[0],i(t,l[1])]),y],p=l.literal={true:!0,false:!1,null:null},d=l.postfix=[(r,t,l)=>(46===t?(e++,s(),r=[".",r,'"'+y()+'"']):91===t?(e++,r=[".",r,i(93)],e++):40===t&&(e++,l=i(41),41!==n()&&o(),r=Array.isArray(l)&&","===l[0]?(l[0]=r,l):null==l?[r]:[r,l],e++),r),(t,l)=>43!==l&&45!==l||r.charCodeAt(e+1)!==l?t:[u(2),t]],h=l.unary={"-":17,"!":17,"+":17,"++":17,"--":17},g=l.binary={",":1,"||":6,"&&":7,"|":8,"^":9,"&":10,"==":11,"!=":11,"<":12,">":12,"<=":12,">=":12,"<<":13,">>":13,">>>":13,"+":14,"-":14,"*":15,"/":15,"%":15},A=l,b=e=>Array.isArray(e)&&("string"==typeof e[0]||b(e[0])),m=(e,r={},t,l)=>b(e)?("string"==typeof(t=e[0])&&(l=v[t]),"function"!=typeof(t=l||m(t,r))?t:t.call(...e.map((e=>m(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e,v=m.operator={"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))},w=m,x=e=>(e="string"==typeof e?A(e):e,r=>w(e,r));export{x as default,w as evaluate,A as parse};