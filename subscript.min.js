var e,r,n,t=()=>r.charCodeAt(e),l=(n=1)=>r.substr(e,n),o=r=>{throw Error(r+" at "+e)},u=(n=1,l=e)=>{if("number"==typeof n)e+=n;else for(;n(t());)++e>r.length&&o("Unexpected end "+n);return e>l?r.slice(l,e):null},a=()=>{for(;t()<=32;)e++},s=(r,t,o,u=3)=>{if(e&&n&&n[3]===e)return n;for(;u;)if(null!=(o=r[t=l(u--)]))return n=[t,o,t.length,e]},i=(r,n=-1)=>{a();let o,u,f=t();if(l(),p.pre.find((e=>null!=(u=e()))),null==u)(o=s(p.unary))&&(e+=o[2],u=[o[0],i(r,o[1])]);else do{a()}while(p.post.find(((e,r)=>(r=e(u))!==u&&(u=r))));for(a();(f=t())&&f!==r&&(o=s(p.binary))&&o[1]>n;){u=[o[0],u];do{e+=o[2],u.push(i(r,o[1]))}while(l(o[2])===o[0]);a()}return u},f=()=>u((e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192)),p=Object.assign((t=>(r=t,e=n=0,i())),{pre:[(r=40,n=41,l)=>t()===r?(e++,l=i(n),e++,l):null,(r,n,o)=>{if(r=u(o=e=>e>=48&&e<=57)||"",46===t()&&(e++,r+="."+u(o)),r)return(69===(n=t())||101===n)&&(e++,r+="e",(43===(n=t())||45===n)&&(r+=l(),e++),r+=u(o)),parseFloat(r)},(r=t(),n)=>34===r||39===r?(n=l(),e++,n+u((e=>e!==r))+(e++,n)):null,f],post:[e=>"string"==typeof e?"true"===e||"false"!==e&&("null"===e?null:e):e,r=>46===t()?(e++,a(),[".",r,'"'+f()+'"']):r,r=>(91===t()&&(e++,r=[".",r,i(93)],e++),r),(r,n)=>(40===t()&&(e++,n=i(41),r=Array.isArray(n)&&","===n[0]?(n[0]=r,n):null==n?[r]:[r,n],e++),r)],unary:{"-":17,"!":17,"+":17,"++":17,"--":17},binary:{",":1,"||":6,"&&":7,"|":8,"^":9,"&":10,"==":11,"!=":11,"<":12,">":12,"<=":12,">=":12,"<<":13,">>":13,">>>":13,"+":14,"-":14,"*":15,"/":15,"%":15}}),c=p,y=e=>Array.isArray(e)&&("string"==typeof e[0]||y(e[0])),d=Object.assign(((e,r={},n,t)=>y(e)?("string"==typeof(n=e[0])&&(t=d.operator[n]),"function"!=typeof(n=t||d(n,r))?n:n.call(...e.map((e=>d(e,r))))):e&&"string"==typeof e?'"'===e[0]?e.slice(1,-1):"@"===e[0]?e.slice(1):e in r?r[e]:e:e),{operator:{"!":e=>!e,"++":e=>++e,"--":e=>--e,".":(...e)=>e.reduce(((e,r)=>e&&e[r])),"%":(...e)=>e.reduce(((e,r)=>e%r)),"/":(...e)=>e.reduce(((e,r)=>e/r)),"*":(...e)=>e.reduce(((e,r)=>e*r)),"+":(...e)=>e.reduce(((e,r)=>e+r)),"-":(...e)=>e.length<2?-e:e.reduce(((e,r)=>e-r)),">>>":(e,r)=>e>>>r,">>":(e,r)=>e>>r,"<<":(e,r)=>e<<r,">=":(e,r)=>e>=r,">":(e,r)=>e>r,"<=":(e,r)=>e<=r,"<":(e,r)=>e<r,"!=":(e,r)=>e!=r,"==":(e,r)=>e==r,"&":(e,r)=>e&r,"^":(e,r)=>e^r,"|":(e,r)=>e|r,"&&":(...e)=>e.every(Boolean),"||":(...e)=>e.some(Boolean),",":(...e)=>e.reduce(((e,r)=>r))}}),g=d,h=e=>(e="string"==typeof e?c(e):e,r=>g(e,r));export{h as default,g as evaluate,c as parse};