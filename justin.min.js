let r,e,t=t=>(r=0,e=t,t=n(),e[r]?a():t||""),a=(t="Bad syntax",a=e.slice(0,r).split("\n"),s=a.pop())=>{let n=e.slice(r-108,r).split("\n").pop(),i=e.slice(r,r+108).split("\n").shift();throw EvalError(`${t} at ${a.length}:${s.length} \`${r>=108?"…":""}${n}▶${i}\``,"font-weight: bold")},s=(t=1,a=r,s)=>{if("number"==typeof t)r+=t;else for(;s=t(e.charCodeAt(r));)r+=s;return e.slice(a,r)},n=(e=0,s,n,i,p,l)=>{for(;(n=t.space())&&(p=((l=o[n])&&l(i,e))??(!i&&t.id()));)i=p;return s&&(n==s?r++:a()),i},i=r=>r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||36==r||95==r||r>=192&&215!=r&&247!=r,p=t.id=()=>s(i),l=t.space=t=>{for(;(t=e.charCodeAt(r))<=32;)r++;return t},o=[],c=(t,a=32,s,n=t.charCodeAt(0),p=t.length,l=o[n],c=t.toUpperCase()!==t)=>o[n]=(n,o,d=r)=>o<a&&(p<2||e.substr(r,p)==t)&&(!c||!i(e.charCodeAt(r+p)))&&(r+=p,s(n,o))||(r=d,l?.(n,o)),d=(r,e,t=!1)=>c(r,e,((a,s)=>a&&(s=n(e-(t?.5:0)))&&[r,a,s])),f=(r,e,t)=>c(r,e,(a=>t?a&&[r,a]:!a&&(a=n(e-.5))&&[r,a])),h=(r,e)=>{c(r,e,((t,a)=>(a=n(e),(!t||t[0]!==r)&&(t=[r,t]),t.push(a),t)))},m=(r,e)=>c(r[0],e,(e=>!e&&[r,n(0,r.charCodeAt(1))])),A=(r,e)=>c(r[0],e,(e=>e&&[r[0],e,n(0,r.charCodeAt(1))]));const b=r=>Array.isArray(r)?r[0]?u[r[0]](...r.slice(1)):()=>r[1]:e=>e?.[r],u={},y=(r,e,t=u[r])=>u[r]=(...r)=>e(...r)||t&&t(...r),C=(r,e,t)=>"()"===r[0]?C(r[1],e,t):"string"==typeof r?e.bind(0,(r=>r),(()=>r)):"."===r[0]?e.bind(0,b(r[1]),(r=r[2],()=>r)):"["===r[0]?e.bind(0,b(r[1]),b(r[2])):t?(r=b(r),e.bind(0,(e=>[r(e)]),(()=>0))):()=>a("Bad left value"),g=r=>r?a():[,(r=+s((r=>46===r||r>=48&&r<=57||(69===r||101===r?2:0))))!=r?a():r];o[46]=r=>!r&&g();for(let r=48;r<=57;r++)o[r]=g;const $={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},v=t=>(n,i,p="")=>{for(n&&a("Unexpected string"),s();(i=e.charCodeAt(r))-t;)92===i?(s(),i=s(),p+=$[i]||i):p+=s();return s()||a("Bad string"),[,p]};o[34]=v(34),o[39]=v(39),A("()",17),y("(",((r,e,t)=>(t=e?","===e[0]?(e=e.slice(1).map((r=>r?b(r):err())),r=>e.map((e=>e(r)))):(e=b(e),r=>[e(r)]):()=>[],C(r,((r,e,a)=>r(a)[e(a)](...t(a))),!0)))),A("[]",17),y("[",((r,e)=>e?(r=b(r),e=b(e),t=>r(t)[e(t)]):err())),d(".",17),y(".",((r,e)=>(r=b(r),e=e[0]?e:e[1],t=>r(t)[e]))),m("()",17),y("()",(r=>(!r&&a("Empty ()"),b(r))));const E=(...r)=>(r=r.map(b),e=>r.map((r=>r(e))).pop());h(",",1),y(",",E),h(";",1),y(";",E),d("*",12),y("*",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)*e(t)))),d("/",12),y("/",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)/e(t)))),d("%",12),y("%",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)%e(t)))),d("*=",2,!0),y("*=",((r,e)=>(e=b(e),C(r,((r,t,a)=>r(a)[t(a)]*=e(a)))))),d("/=",2,!0),y("/=",((r,e)=>(e=b(e),C(r,((r,t,a)=>r(a)[t(a)]/=e(a)))))),d("%=",2,!0),y("%=",((r,e)=>(e=b(e),C(r,((r,t,a)=>r(a)[t(a)]%=e(a)))))),f("+",14),y("+",((r,e)=>!e&&(r=b(r),e=>+r(e)))),f("-",14),y("-",((r,e)=>!e&&(r=b(r),e=>-r(e)))),d("+",11),y("+",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)+e(t)))),d("-",11),y("-",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)-e(t)))),d("+=",2,!0),y("+=",((r,e)=>(e=b(e),C(r,((r,t,a)=>r(a)[t(a)]+=e(a)))))),d("-=",2,!0),y("-=",((r,e)=>(e=b(e),C(r,((r,t,a)=>r(a)[t(a)]-=e(a)))))),c("++",15,(r=>r?["-",["++",r],[,1]]:["++",n(14)])),y("++",(r=>C(r,((r,e,t)=>++r(t)[e(t)])))),c("--",15,(r=>r?["+",["--",r],[,1]]:["--",n(14)])),y("--",(r=>C(r,((r,e,t)=>--r(t)[e(t)])))),f("~",14),y("~",((r,e)=>!e&&(r=b(r),e=>~r(e)))),d("|",5),y("|",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)|e(t)))),d("&",7),y("&",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)&e(t)))),d("^",6),y("^",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)^e(t)))),d(">>",10),y(">>",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)>>e(t)))),d("<<",10),y("<<",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)<<e(t)))),d("==",8),y("==",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)==e(t)))),d("!=",8),y("!=",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)!=e(t)))),d(">",8),y(">",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)>e(t)))),d("<",8),y("<",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)<e(t)))),d(">=",8),y(">=",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)>=e(t)))),d("<=",8),y("<=",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)<=e(t)))),f("!",14),y("!",((r,e)=>!e&&(r=b(r),e=>!r(e)))),d("||",3),y("||",((r,e)=>(r=b(r),e=b(e),t=>r(t)||e(t)))),d("&&",4),y("&&",((r,e)=>(r=b(r),e=b(e),t=>r(t)&&e(t)))),d("=",2,!0),y("=",((r,e)=>(e=b(e),C(r,((r,t,a)=>r(a)[t(a)]=e(a))))));var x=r=>b(t(r));c("/*",20,((t,a)=>(s((t=>42!==t&&47!==e.charCodeAt(r+1))),s(2),t||n(a)||[]))),c("//",20,((r,e)=>(s((r=>r>=32)),r||n(e)||[""]))),d("**",13,!0),y("**",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)**e(t)))),d("in",9),y("in",((r,e)=>e&&(r=b(r),e=b(e),t=>r(t)in e(t)))),c("?",2,((r,e,t)=>r&&(e=n(2,58))&&["?",r,e,n(3)])),y("?",((r,e,t)=>(r=b(r),e=b(e),t=b(t),a=>r(a)?e(a):t(a)))),c("true",20,(r=>r?err():[,!0])),c("false",20,(r=>r?err():[,!1])),m("[]",20),y("[]",((r,e)=>r?","===r[0]?(r=r.slice(1).map(b),e=>r.map((r=>r(e)))):(r=b(r),e=>[r(e)]):()=>[])),m("{}",20),y("{}",((r,e)=>r?","===r[0]?(r=r.slice(1).map(b),e=>Object.fromEntries(r.map((r=>r(e))))):":"===r[0]?(r=b(r),e=>Object.fromEntries([r(e)])):(e=b(r),t=>({[r]:e(t)})):()=>({}))),d(":",2,!0),y(":",((r,e)=>(e=b(e),r=Array.isArray(r)?b(r):(r=>r).bind(0,r),t=>[r(t),e(t)]))),c("?.",17,(r=>r&&["?.",r])),y("?.",(r=>(r=b(r),e=>r(e)||(()=>{})))),c("?.",17,((r,e)=>r&&!(e=n(17))?.map&&["?.",r,e])),y("?.",((r,e)=>e&&(r=b(r),t=>r(t)?.[e]))),y("(",((r,e,t,a,s,n)=>"?."===r[0]&&(r[2]||Array.isArray(r[1]))&&(a=e?","===e[0]?(e=e.slice(1).map(b),r=>e.map((e=>e(r)))):(e=b(e),r=>[e(r)]):()=>[],!r[2]&&(r=r[1]),s="["===r[0]?b(r[2]):()=>r[2],t=b(r[1]),r=>t(r)?.[s(r)]?.(...a(r))))),c("null",20,(r=>r?a():[,null]));export{A as access,d as binary,b as compile,e as cur,x as default,a as err,n as expr,m as group,p as id,r as idx,i as isId,o as lookup,h as nary,y as operator,u as operators,t as parse,C as prop,s as skip,l as space,c as token,f as unary};